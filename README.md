{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "74c62eaf-c184-409c-8a37-7077a019baff",
   "metadata": {},
   "source": [
    "# TensorRT-LLM - Llama 3 1M Context"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b559fe93-4a5b-400a-a03f-15d6d94ac8f0",
   "metadata": {},
   "source": [
    "##### https://github.com/NVIDIA/TensorRT-LLM/tree/main/examples/llama#1m-long-context-test-case"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6bc2734a-7e27-412b-841e-86c075975ae5",
   "metadata": {},
   "source": [
    "### 15 July 2024\n",
    "### nvcr.io/nvidia/rapidsai/notebooks:24.04-cuda12.0-py3.10"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d2101baa-68b5-4584-b913-e74b7424abf5",
   "metadata": {},
   "source": [
    "  "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3061b4c9-092c-4bfa-b5d3-fcdbeb22daa4",
   "metadata": {},
   "source": [
    "### VM Specs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "80efb7b3-2c19-410c-ba1d-6a853c00734d",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Linux verb-workspace 6.2.0-37-generic #38~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Thu Nov  2 18:01:13 UTC 2 x86_64 x86_64 x86_64 GNU/Linux\n"
     ]
    }
   ],
   "source": [
    "!uname -a"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "fd31c1b8-a58b-4153-b8bf-550917a8d480",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "DISTRIB_ID=Ubuntu\n",
      "DISTRIB_RELEASE=22.04\n",
      "DISTRIB_CODENAME=jammy\n",
      "DISTRIB_DESCRIPTION=\"Ubuntu 22.04.4 LTS\"\n"
     ]
    }
   ],
   "source": [
    "!cat /etc/lsb-release"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "b966d4ee-64a1-4e23-8880-beda6f2297f8",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Mon Jul 15 22:30:14 2024       \n",
      "+---------------------------------------------------------------------------------------+\n",
      "| NVIDIA-SMI 535.129.03             Driver Version: 535.129.03   CUDA Version: 12.2     |\n",
      "|-----------------------------------------+----------------------+----------------------+\n",
      "| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |\n",
      "| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |\n",
      "|                                         |                      |               MIG M. |\n",
      "|=========================================+======================+======================|\n",
      "|   0  NVIDIA A100-SXM4-40GB          On  | 00000000:07:00.0 Off |                    0 |\n",
      "| N/A   31C    P0              42W / 400W |      7MiB / 40960MiB |      0%      Default |\n",
      "|                                         |                      |             Disabled |\n",
      "+-----------------------------------------+----------------------+----------------------+\n",
      "                                                                                         \n",
      "+---------------------------------------------------------------------------------------+\n",
      "| Processes:                                                                            |\n",
      "|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |\n",
      "|        ID   ID                                                             Usage      |\n",
      "|=======================================================================================|\n",
      "|  No running processes found                                                           |\n",
      "+---------------------------------------------------------------------------------------+\n"
     ]
    }
   ],
   "source": [
    "!nvidia-smi"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "76506278-6e33-4ec7-a489-5a484c3b3aba",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "               total        used        free      shared  buff/cache   available\n",
      "Mem:           216Gi       2.0Gi        25Gi       5.0Mi       188Gi       212Gi\n",
      "Swap:             0B          0B          0B\n"
     ]
    }
   ],
   "source": [
    "!free -h"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "13c8ad37-13d7-4d5e-803e-a84988b724f9",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "30\n"
     ]
    }
   ],
   "source": [
    "!nproc"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "66e00d9f-0115-4ece-b59c-86b24b31577e",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Python 3.10.14\n"
     ]
    }
   ],
   "source": [
    "!python -V"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "236c885f-fed8-4c00-9f09-15fc8093255c",
   "metadata": {},
   "source": [
    "   "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f24bfb2b-c90f-4bed-ba43-9279768c1c77",
   "metadata": {},
   "source": [
    "# Install System & Python Dependencies   \n",
    "https://nvidia.github.io/TensorRT-LLM/installation/linux.html"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "b6f8a73f-14fb-4016-8486-3fc951786adf",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Reading package lists... Done\n",
      "Building dependency tree... Done\n",
      "Reading state information... Done\n",
      "libopenmpi-dev is already the newest version (4.1.2-2ubuntu1).\n",
      "openmpi-bin is already the newest version (4.1.2-2ubuntu1).\n",
      "python3-mpi4py is already the newest version (3.1.3-1build2).\n",
      "git is already the newest version (1:2.34.1-1ubuntu1.11).\n",
      "python3.10 is already the newest version (3.10.12-1~22.04.4).\n",
      "python3.10-dev is already the newest version (3.10.12-1~22.04.4).\n",
      "git-lfs is already the newest version (3.0.2-1ubuntu0.2).\n",
      "python3-pip is already the newest version (22.0.2+dfsg-1ubuntu0.4).\n",
      "0 upgraded, 0 newly installed, 0 to remove and 23 not upgraded.\n",
      "CPU times: user 21.9 ms, sys: 11.3 ms, total: 33.2 ms\n",
      "Wall time: 1.28 s\n"
     ]
    }
   ],
   "source": [
    "%%time \n",
    "\n",
    "!apt-get -y install python3.10 python3-pip python3.10-dev  openmpi-bin libopenmpi-dev git git-lfs python3-mpi4py"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2d5bcf9f-dc4b-4f46-96e8-3507eb615de2",
   "metadata": {},
   "source": [
    "  "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "020c186a-9f4a-46ce-bb0f-d952f7716302",
   "metadata": {},
   "source": [
    "  "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "db95f63b-a02e-47b8-b255-516f4dd892c9",
   "metadata": {},
   "source": [
    "# Install TensorRT-LLM\n",
    "### For the latest verions, use the '--pre' command line option\n",
    "##### This is needed for the 1M Context use case provided in this notebook"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "1142e5ae-191d-428b-aecb-b64dfae23a85",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Looking in indexes: https://pypi.org/simple, https://pypi.nvidia.com\n",
      "Requirement already satisfied: tensorrt_llm in /opt/conda/lib/python3.10/site-packages (0.12.0.dev2024070900)\n",
      "Requirement already satisfied: accelerate>=0.25.0 in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (0.32.1)\n",
      "Requirement already satisfied: build in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (1.2.1)\n",
      "Requirement already satisfied: colored in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (2.2.4)\n",
      "Requirement already satisfied: cuda-python in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (12.5.0)\n",
      "Requirement already satisfied: diffusers>=0.27.0 in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (0.29.2)\n",
      "Requirement already satisfied: lark in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (1.1.9)\n",
      "Requirement already satisfied: mpi4py in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (3.1.6)\n",
      "Requirement already satisfied: numpy<2 in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (1.26.4)\n",
      "Requirement already satisfied: onnx>=1.12.0 in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (1.16.1)\n",
      "Requirement already satisfied: polygraphy in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (0.49.9)\n",
      "Requirement already satisfied: psutil in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (6.0.0)\n",
      "Requirement already satisfied: pynvml>=11.5.0 in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (11.5.2)\n",
      "Requirement already satisfied: pulp in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (2.9.0)\n",
      "Requirement already satisfied: pandas in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (2.2.2)\n",
      "Requirement already satisfied: h5py==3.10.0 in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (3.10.0)\n",
      "Requirement already satisfied: StrEnum in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (0.4.15)\n",
      "Requirement already satisfied: sentencepiece>=0.1.99 in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (0.2.0)\n",
      "Requirement already satisfied: torch<=2.4.0a0,>=2.3.0a0 in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (2.3.1)\n",
      "Requirement already satisfied: nvidia-modelopt<0.14,~=0.13 in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (0.13.1)\n",
      "Requirement already satisfied: transformers>=4.38.2 in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (4.42.4)\n",
      "Requirement already satisfied: pillow==10.3.0 in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (10.3.0)\n",
      "Requirement already satisfied: wheel in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (0.43.0)\n",
      "Requirement already satisfied: optimum in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (1.21.2)\n",
      "Requirement already satisfied: evaluate in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (0.4.2)\n",
      "Requirement already satisfied: janus in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (1.0.0)\n",
      "Requirement already satisfied: mpmath>=1.3.0 in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (1.3.0)\n",
      "Requirement already satisfied: tensorrt-cu12==10.1.0 in /opt/conda/lib/python3.10/site-packages (from tensorrt_llm) (10.1.0)\n",
      "Requirement already satisfied: tensorrt-cu12-libs==10.1.0 in /opt/conda/lib/python3.10/site-packages (from tensorrt-cu12==10.1.0->tensorrt_llm) (10.1.0)\n",
      "Requirement already satisfied: tensorrt-cu12-bindings==10.1.0 in /opt/conda/lib/python3.10/site-packages (from tensorrt-cu12==10.1.0->tensorrt_llm) (10.1.0)\n",
      "Requirement already satisfied: nvidia-cuda-runtime-cu12 in /opt/conda/lib/python3.10/site-packages (from tensorrt-cu12-libs==10.1.0->tensorrt-cu12==10.1.0->tensorrt_llm) (12.1.105)\n",
      "Requirement already satisfied: packaging>=20.0 in /opt/conda/lib/python3.10/site-packages (from accelerate>=0.25.0->tensorrt_llm) (24.1)\n",
      "Requirement already satisfied: pyyaml in /opt/conda/lib/python3.10/site-packages (from accelerate>=0.25.0->tensorrt_llm) (6.0.1)\n",
      "Requirement already satisfied: huggingface-hub in /opt/conda/lib/python3.10/site-packages (from accelerate>=0.25.0->tensorrt_llm) (0.23.4)\n",
      "Requirement already satisfied: safetensors>=0.3.1 in /opt/conda/lib/python3.10/site-packages (from accelerate>=0.25.0->tensorrt_llm) (0.4.3)\n",
      "Requirement already satisfied: importlib-metadata in /opt/conda/lib/python3.10/site-packages (from diffusers>=0.27.0->tensorrt_llm) (8.0.0)\n",
      "Requirement already satisfied: filelock in /opt/conda/lib/python3.10/site-packages (from diffusers>=0.27.0->tensorrt_llm) (3.15.4)\n",
      "Requirement already satisfied: regex!=2019.12.17 in /opt/conda/lib/python3.10/site-packages (from diffusers>=0.27.0->tensorrt_llm) (2024.5.15)\n",
      "Requirement already satisfied: requests in /opt/conda/lib/python3.10/site-packages (from diffusers>=0.27.0->tensorrt_llm) (2.32.3)\n",
      "Requirement already satisfied: cloudpickle>=1.6.0 in /opt/conda/lib/python3.10/site-packages (from nvidia-modelopt<0.14,~=0.13->tensorrt_llm) (3.0.0)\n",
      "Requirement already satisfied: ninja in /opt/conda/lib/python3.10/site-packages (from nvidia-modelopt<0.14,~=0.13->tensorrt_llm) (1.11.1.1)\n",
      "Requirement already satisfied: pydantic>=2.0 in /opt/conda/lib/python3.10/site-packages (from nvidia-modelopt<0.14,~=0.13->tensorrt_llm) (2.8.2)\n",
      "Requirement already satisfied: rich in /opt/conda/lib/python3.10/site-packages (from nvidia-modelopt<0.14,~=0.13->tensorrt_llm) (13.7.1)\n",
      "Requirement already satisfied: scipy in /opt/conda/lib/python3.10/site-packages (from nvidia-modelopt<0.14,~=0.13->tensorrt_llm) (1.14.0)\n",
      "Requirement already satisfied: tqdm in /opt/conda/lib/python3.10/site-packages (from nvidia-modelopt<0.14,~=0.13->tensorrt_llm) (4.66.4)\n",
      "Requirement already satisfied: protobuf>=3.20.2 in /opt/conda/lib/python3.10/site-packages (from onnx>=1.12.0->tensorrt_llm) (5.27.2)\n",
      "Requirement already satisfied: typing-extensions>=4.8.0 in /opt/conda/lib/python3.10/site-packages (from torch<=2.4.0a0,>=2.3.0a0->tensorrt_llm) (4.8.0)\n",
      "Requirement already satisfied: sympy in /opt/conda/lib/python3.10/site-packages (from torch<=2.4.0a0,>=2.3.0a0->tensorrt_llm) (1.13.0)\n",
      "Requirement already satisfied: networkx in /opt/conda/lib/python3.10/site-packages (from torch<=2.4.0a0,>=2.3.0a0->tensorrt_llm) (3.3)\n",
      "Requirement already satisfied: jinja2 in /opt/conda/lib/python3.10/site-packages (from torch<=2.4.0a0,>=2.3.0a0->tensorrt_llm) (3.1.4)\n",
      "Requirement already satisfied: fsspec in /opt/conda/lib/python3.10/site-packages (from torch<=2.4.0a0,>=2.3.0a0->tensorrt_llm) (2024.3.1)\n",
      "Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in /opt/conda/lib/python3.10/site-packages (from torch<=2.4.0a0,>=2.3.0a0->tensorrt_llm) (12.1.105)\n",
      "Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in /opt/conda/lib/python3.10/site-packages (from torch<=2.4.0a0,>=2.3.0a0->tensorrt_llm) (12.1.105)\n",
      "Requirement already satisfied: nvidia-cudnn-cu12==8.9.2.26 in /opt/conda/lib/python3.10/site-packages (from torch<=2.4.0a0,>=2.3.0a0->tensorrt_llm) (8.9.2.26)\n",
      "Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in /opt/conda/lib/python3.10/site-packages (from torch<=2.4.0a0,>=2.3.0a0->tensorrt_llm) (12.1.3.1)\n",
      "Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in /opt/conda/lib/python3.10/site-packages (from torch<=2.4.0a0,>=2.3.0a0->tensorrt_llm) (11.0.2.54)\n",
      "Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in /opt/conda/lib/python3.10/site-packages (from torch<=2.4.0a0,>=2.3.0a0->tensorrt_llm) (10.3.2.106)\n",
      "Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in /opt/conda/lib/python3.10/site-packages (from torch<=2.4.0a0,>=2.3.0a0->tensorrt_llm) (11.4.5.107)\n",
      "Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in /opt/conda/lib/python3.10/site-packages (from torch<=2.4.0a0,>=2.3.0a0->tensorrt_llm) (12.1.0.106)\n",
      "Requirement already satisfied: nvidia-nccl-cu12==2.20.5 in /opt/conda/lib/python3.10/site-packages (from torch<=2.4.0a0,>=2.3.0a0->tensorrt_llm) (2.20.5)\n",
      "Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in /opt/conda/lib/python3.10/site-packages (from torch<=2.4.0a0,>=2.3.0a0->tensorrt_llm) (12.1.105)\n",
      "Requirement already satisfied: triton==2.3.1 in /opt/conda/lib/python3.10/site-packages (from torch<=2.4.0a0,>=2.3.0a0->tensorrt_llm) (2.3.1)\n",
      "Requirement already satisfied: nvidia-nvjitlink-cu12 in /opt/conda/lib/python3.10/site-packages (from nvidia-cusolver-cu12==11.4.5.107->torch<=2.4.0a0,>=2.3.0a0->tensorrt_llm) (12.5.82)\n",
      "Requirement already satisfied: tokenizers<0.20,>=0.19 in /opt/conda/lib/python3.10/site-packages (from transformers>=4.38.2->tensorrt_llm) (0.19.1)\n",
      "Requirement already satisfied: pyproject_hooks in /opt/conda/lib/python3.10/site-packages (from build->tensorrt_llm) (1.1.0)\n",
      "Requirement already satisfied: tomli>=1.1.0 in /opt/conda/lib/python3.10/site-packages (from build->tensorrt_llm) (2.0.1)\n",
      "Requirement already satisfied: datasets>=2.0.0 in /opt/conda/lib/python3.10/site-packages (from evaluate->tensorrt_llm) (2.19.2)\n",
      "Requirement already satisfied: dill in /opt/conda/lib/python3.10/site-packages (from evaluate->tensorrt_llm) (0.3.8)\n",
      "Requirement already satisfied: xxhash in /opt/conda/lib/python3.10/site-packages (from evaluate->tensorrt_llm) (3.4.1)\n",
      "Requirement already satisfied: multiprocess in /opt/conda/lib/python3.10/site-packages (from evaluate->tensorrt_llm) (0.70.16)\n",
      "Requirement already satisfied: coloredlogs in /opt/conda/lib/python3.10/site-packages (from optimum->tensorrt_llm) (15.0.1)\n",
      "Requirement already satisfied: python-dateutil>=2.8.2 in /opt/conda/lib/python3.10/site-packages (from pandas->tensorrt_llm) (2.9.0.post0)\n",
      "Requirement already satisfied: pytz>=2020.1 in /opt/conda/lib/python3.10/site-packages (from pandas->tensorrt_llm) (2024.1)\n",
      "Requirement already satisfied: tzdata>=2022.7 in /opt/conda/lib/python3.10/site-packages (from pandas->tensorrt_llm) (2024.1)\n",
      "Requirement already satisfied: pyarrow>=12.0.0 in /opt/conda/lib/python3.10/site-packages (from datasets>=2.0.0->evaluate->tensorrt_llm) (16.1.0)\n",
      "Requirement already satisfied: pyarrow-hotfix in /opt/conda/lib/python3.10/site-packages (from datasets>=2.0.0->evaluate->tensorrt_llm) (0.6)\n",
      "Requirement already satisfied: aiohttp in /opt/conda/lib/python3.10/site-packages (from datasets>=2.0.0->evaluate->tensorrt_llm) (3.9.5)\n",
      "Requirement already satisfied: annotated-types>=0.4.0 in /opt/conda/lib/python3.10/site-packages (from pydantic>=2.0->nvidia-modelopt<0.14,~=0.13->tensorrt_llm) (0.7.0)\n",
      "Requirement already satisfied: pydantic-core==2.20.1 in /opt/conda/lib/python3.10/site-packages (from pydantic>=2.0->nvidia-modelopt<0.14,~=0.13->tensorrt_llm) (2.20.1)\n",
      "Requirement already satisfied: six>=1.5 in /opt/conda/lib/python3.10/site-packages (from python-dateutil>=2.8.2->pandas->tensorrt_llm) (1.16.0)\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in /opt/conda/lib/python3.10/site-packages (from requests->diffusers>=0.27.0->tensorrt_llm) (3.3.2)\n",
      "Requirement already satisfied: idna<4,>=2.5 in /opt/conda/lib/python3.10/site-packages (from requests->diffusers>=0.27.0->tensorrt_llm) (3.7)\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in /opt/conda/lib/python3.10/site-packages (from requests->diffusers>=0.27.0->tensorrt_llm) (2.2.2)\n",
      "Requirement already satisfied: certifi>=2017.4.17 in /opt/conda/lib/python3.10/site-packages (from requests->diffusers>=0.27.0->tensorrt_llm) (2024.7.4)\n",
      "Requirement already satisfied: humanfriendly>=9.1 in /opt/conda/lib/python3.10/site-packages (from coloredlogs->optimum->tensorrt_llm) (10.0)\n",
      "Requirement already satisfied: zipp>=0.5 in /opt/conda/lib/python3.10/site-packages (from importlib-metadata->diffusers>=0.27.0->tensorrt_llm) (3.19.2)\n",
      "Requirement already satisfied: MarkupSafe>=2.0 in /opt/conda/lib/python3.10/site-packages (from jinja2->torch<=2.4.0a0,>=2.3.0a0->tensorrt_llm) (2.1.5)\n",
      "Requirement already satisfied: markdown-it-py>=2.2.0 in /opt/conda/lib/python3.10/site-packages (from rich->nvidia-modelopt<0.14,~=0.13->tensorrt_llm) (3.0.0)\n",
      "Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /opt/conda/lib/python3.10/site-packages (from rich->nvidia-modelopt<0.14,~=0.13->tensorrt_llm) (2.18.0)\n",
      "Requirement already satisfied: aiosignal>=1.1.2 in /opt/conda/lib/python3.10/site-packages (from aiohttp->datasets>=2.0.0->evaluate->tensorrt_llm) (1.3.1)\n",
      "Requirement already satisfied: attrs>=17.3.0 in /opt/conda/lib/python3.10/site-packages (from aiohttp->datasets>=2.0.0->evaluate->tensorrt_llm) (23.2.0)\n",
      "Requirement already satisfied: frozenlist>=1.1.1 in /opt/conda/lib/python3.10/site-packages (from aiohttp->datasets>=2.0.0->evaluate->tensorrt_llm) (1.4.1)\n",
      "Requirement already satisfied: multidict<7.0,>=4.5 in /opt/conda/lib/python3.10/site-packages (from aiohttp->datasets>=2.0.0->evaluate->tensorrt_llm) (6.0.5)\n",
      "Requirement already satisfied: yarl<2.0,>=1.0 in /opt/conda/lib/python3.10/site-packages (from aiohttp->datasets>=2.0.0->evaluate->tensorrt_llm) (1.9.4)\n",
      "Requirement already satisfied: async-timeout<5.0,>=4.0 in /opt/conda/lib/python3.10/site-packages (from aiohttp->datasets>=2.0.0->evaluate->tensorrt_llm) (4.0.3)\n",
      "Requirement already satisfied: mdurl~=0.1 in /opt/conda/lib/python3.10/site-packages (from markdown-it-py>=2.2.0->rich->nvidia-modelopt<0.14,~=0.13->tensorrt_llm) (0.1.2)\n",
      "\u001b[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\u001b[0m\u001b[33m\n",
      "\u001b[0mCPU times: user 58.9 ms, sys: 27.1 ms, total: 86 ms\n",
      "Wall time: 5.23 s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "# 4+ minutes\n",
    "\n",
    "# latest version —> add --pre after ‘-U’\n",
    "# stable version —> no `--pre` option. Will be v0.10 (15 Jul '24)\n",
    "\n",
    "!pip3 install tensorrt_llm -U --pre --extra-index-url https://pypi.nvidia.com"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "173f7596-3e97-4c7b-b1b8-58ac871c299b",
   "metadata": {},
   "source": [
    "  "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "35231128-d6f2-4b6b-a727-d30c07016ce7",
   "metadata": {},
   "source": [
    "  "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1aad465d-cf95-49b6-9d97-2595fd69450b",
   "metadata": {},
   "source": [
    "### Test TensorRT-LLM Installation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "0073e710-e3d9-413b-887b-097fe46bb89d",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[TensorRT-LLM] TensorRT-LLM version: 0.12.0.dev2024070900\n"
     ]
    }
   ],
   "source": [
    "import tensorrt_llm"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "bc54bde7-cbbb-479f-8740-8724421673f5",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'0.12.0.dev2024070900'"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tensorrt_llm.__version__"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "84bee6f9-36fe-4761-b715-a0163c89437c",
   "metadata": {},
   "source": [
    "  "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "134ceec0-dfeb-4c8d-8227-33b369a3ceae",
   "metadata": {},
   "source": [
    "  "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0ef92802-ba5a-4ade-aa0a-0bfd75e08527",
   "metadata": {},
   "source": [
    "# git clone TensorRT-LLM code\n",
    "### 3 minutes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "5454f1a5-de62-4529-8e9d-6637cc81320b",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Cloning into 'TensorRT-LLM'...\n",
      "remote: Enumerating objects: 19939, done.\u001b[K\n",
      "remote: Counting objects: 100% (9518/9518), done.\u001b[K\n",
      "remote: Compressing objects: 100% (2362/2362), done.\u001b[K\n",
      "remote: Total 19939 (delta 7631), reused 8358 (delta 7118), pack-reused 10421\u001b[K\n",
      "Receiving objects: 100% (19939/19939), 298.50 MiB | 56.48 MiB/s, done.\n",
      "Resolving deltas: 100% (14668/14668), done.\n",
      "Updating files: 100% (2422/2422), done.\n",
      "Filtering content: 100% (14/14), 212.51 MiB | 113.75 MiB/s, done.\n",
      "CPU times: user 151 ms, sys: 66.8 ms, total: 218 ms\n",
      "Wall time: 13.5 s\n"
     ]
    }
   ],
   "source": [
    "%%time \n",
    "# 13 seconds\n",
    "\n",
    "!git clone https://github.com/NVIDIA/TensorRT-LLM.git"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2627c292-c036-4acf-a1e9-865c1e5525c8",
   "metadata": {},
   "source": [
    "### Intall dependencies"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "d237db4d-21ce-4f93-8253-ad9c9f01eee8",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "-r requirements.txt\n",
      "datasets==2.19.2\n",
      "einops\n",
      "graphviz\n",
      "mypy\n",
      "parameterized\n",
      "pre-commit\n",
      "pybind11\n",
      "pybind11-stubgen\n",
      "pytest-cov\n",
      "pytest-forked\n",
      "pytest-xdist\n",
      "rouge_score\n",
      "cloudpickle\n",
      "typing-extensions==4.8.0\n",
      "bandit==1.7.7\n",
      "jsonlines==4.0.0\n",
      "jieba==0.42.1\n",
      "rouge==1.0.1\n"
     ]
    }
   ],
   "source": [
    "!cat TensorRT-LLM/requirements-dev.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "f7955b16-b5e3-4026-a8dc-188650b42a61",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Looking in indexes: https://pypi.org/simple, https://pypi.nvidia.com\n",
      "Ignoring tensorrt: markers 'platform_machine == \"aarch64\"' don't match your environment\n",
      "Collecting accelerate>=0.25.0 (from -r TensorRT-LLM/requirements.txt (line 2))\n",
      "  Using cached accelerate-0.32.1-py3-none-any.whl.metadata (18 kB)\n",
      "Collecting build (from -r TensorRT-LLM/requirements.txt (line 3))\n",
      "  Using cached build-1.2.1-py3-none-any.whl.metadata (4.3 kB)\n",
      "Collecting colored (from -r TensorRT-LLM/requirements.txt (line 4))\n",
      "  Using cached colored-2.2.4-py3-none-any.whl.metadata (3.6 kB)\n",
      "Collecting cuda-python (from -r TensorRT-LLM/requirements.txt (line 5))\n",
      "  Using cached cuda_python-12.5.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (12 kB)\n",
      "Collecting diffusers>=0.27.0 (from -r TensorRT-LLM/requirements.txt (line 6))\n",
      "  Using cached diffusers-0.29.2-py3-none-any.whl.metadata (19 kB)\n",
      "Collecting lark (from -r TensorRT-LLM/requirements.txt (line 7))\n",
      "  Using cached lark-1.1.9-py3-none-any.whl.metadata (1.9 kB)\n",
      "Collecting mpi4py (from -r TensorRT-LLM/requirements.txt (line 8))\n",
      "  Using cached mpi4py-3.1.6-cp310-cp310-linux_x86_64.whl\n",
      "Collecting numpy<2 (from -r TensorRT-LLM/requirements.txt (line 9))\n",
      "  Using cached numpy-1.26.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (61 kB)\n",
      "Collecting onnx>=1.12.0 (from -r TensorRT-LLM/requirements.txt (line 10))\n",
      "  Using cached onnx-1.16.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (16 kB)\n",
      "Collecting polygraphy (from -r TensorRT-LLM/requirements.txt (line 11))\n",
      "  Using cached https://pypi.nvidia.com/polygraphy/polygraphy-0.49.9-py2.py3-none-any.whl (346 kB)\n",
      "Collecting psutil (from -r TensorRT-LLM/requirements.txt (line 12))\n",
      "  Using cached psutil-6.0.0-cp36-abi3-manylinux_2_12_x86_64.manylinux2010_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (21 kB)\n",
      "Collecting pynvml>=11.5.0 (from -r TensorRT-LLM/requirements.txt (line 13))\n",
      "  Using cached pynvml-11.5.2-py3-none-any.whl.metadata (8.8 kB)\n",
      "Collecting pulp (from -r TensorRT-LLM/requirements.txt (line 14))\n",
      "  Using cached PuLP-2.9.0-py3-none-any.whl.metadata (5.4 kB)\n",
      "Collecting pandas (from -r TensorRT-LLM/requirements.txt (line 15))\n",
      "  Using cached pandas-2.2.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (19 kB)\n",
      "Collecting h5py==3.10.0 (from -r TensorRT-LLM/requirements.txt (line 16))\n",
      "  Using cached h5py-3.10.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (2.5 kB)\n",
      "Collecting StrEnum (from -r TensorRT-LLM/requirements.txt (line 17))\n",
      "  Using cached StrEnum-0.4.15-py3-none-any.whl.metadata (5.3 kB)\n",
      "Collecting sentencepiece>=0.1.99 (from -r TensorRT-LLM/requirements.txt (line 18))\n",
      "  Using cached sentencepiece-0.2.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (7.7 kB)\n",
      "Collecting tensorrt-cu12==10.1.0 (from -r TensorRT-LLM/requirements.txt (line 19))\n",
      "  Using cached tensorrt_cu12-10.1.0-py2.py3-none-any.whl\n",
      "Collecting torch<=2.4.0a0,>=2.3.0a0 (from -r TensorRT-LLM/requirements.txt (line 23))\n",
      "  Using cached torch-2.3.1-cp310-cp310-manylinux1_x86_64.whl.metadata (26 kB)\n",
      "Collecting nvidia-modelopt<0.14,~=0.13 (from -r TensorRT-LLM/requirements.txt (line 24))\n",
      "  Using cached https://pypi.nvidia.com/nvidia-modelopt/nvidia_modelopt-0.13.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.7 MB)\n",
      "Collecting transformers>=4.38.2 (from -r TensorRT-LLM/requirements.txt (line 25))\n",
      "  Using cached transformers-4.42.4-py3-none-any.whl.metadata (43 kB)\n",
      "Collecting pillow==10.3.0 (from -r TensorRT-LLM/requirements.txt (line 26))\n",
      "  Using cached pillow-10.3.0-cp310-cp310-manylinux_2_28_x86_64.whl.metadata (9.2 kB)\n",
      "Collecting wheel (from -r TensorRT-LLM/requirements.txt (line 27))\n",
      "  Using cached wheel-0.43.0-py3-none-any.whl.metadata (2.2 kB)\n",
      "Collecting optimum (from -r TensorRT-LLM/requirements.txt (line 28))\n",
      "  Using cached optimum-1.21.2-py3-none-any.whl.metadata (19 kB)\n",
      "Collecting evaluate (from -r TensorRT-LLM/requirements.txt (line 29))\n",
      "  Using cached evaluate-0.4.2-py3-none-any.whl.metadata (9.3 kB)\n",
      "Collecting janus (from -r TensorRT-LLM/requirements.txt (line 30))\n",
      "  Using cached janus-1.0.0-py3-none-any.whl.metadata (4.5 kB)\n",
      "Collecting mpmath>=1.3.0 (from -r TensorRT-LLM/requirements.txt (line 31))\n",
      "  Using cached mpmath-1.3.0-py3-none-any.whl.metadata (8.6 kB)\n",
      "Collecting datasets==2.19.2 (from -r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached datasets-2.19.2-py3-none-any.whl.metadata (19 kB)\n",
      "Collecting einops (from -r TensorRT-LLM/requirements-dev.txt (line 3))\n",
      "  Using cached einops-0.8.0-py3-none-any.whl.metadata (12 kB)\n",
      "Collecting graphviz (from -r TensorRT-LLM/requirements-dev.txt (line 4))\n",
      "  Using cached graphviz-0.20.3-py3-none-any.whl.metadata (12 kB)\n",
      "Collecting mypy (from -r TensorRT-LLM/requirements-dev.txt (line 5))\n",
      "  Using cached mypy-1.10.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (1.9 kB)\n",
      "Collecting parameterized (from -r TensorRT-LLM/requirements-dev.txt (line 6))\n",
      "  Using cached parameterized-0.9.0-py2.py3-none-any.whl.metadata (18 kB)\n",
      "Collecting pre-commit (from -r TensorRT-LLM/requirements-dev.txt (line 7))\n",
      "  Using cached pre_commit-3.7.1-py2.py3-none-any.whl.metadata (1.3 kB)\n",
      "Collecting pybind11 (from -r TensorRT-LLM/requirements-dev.txt (line 8))\n",
      "  Using cached pybind11-2.13.1-py3-none-any.whl.metadata (9.5 kB)\n",
      "Collecting pybind11-stubgen (from -r TensorRT-LLM/requirements-dev.txt (line 9))\n",
      "  Using cached pybind11_stubgen-2.5.1-py3-none-any.whl.metadata (1.7 kB)\n",
      "Collecting pytest-cov (from -r TensorRT-LLM/requirements-dev.txt (line 10))\n",
      "  Using cached pytest_cov-5.0.0-py3-none-any.whl.metadata (27 kB)\n",
      "Collecting pytest-forked (from -r TensorRT-LLM/requirements-dev.txt (line 11))\n",
      "  Using cached pytest_forked-1.6.0-py3-none-any.whl.metadata (3.5 kB)\n",
      "Collecting pytest-xdist (from -r TensorRT-LLM/requirements-dev.txt (line 12))\n",
      "  Using cached pytest_xdist-3.6.1-py3-none-any.whl.metadata (4.3 kB)\n",
      "Collecting rouge_score (from -r TensorRT-LLM/requirements-dev.txt (line 13))\n",
      "  Using cached rouge_score-0.1.2-py3-none-any.whl\n",
      "Collecting cloudpickle (from -r TensorRT-LLM/requirements-dev.txt (line 14))\n",
      "  Using cached cloudpickle-3.0.0-py3-none-any.whl.metadata (7.0 kB)\n",
      "Collecting typing-extensions==4.8.0 (from -r TensorRT-LLM/requirements-dev.txt (line 15))\n",
      "  Using cached typing_extensions-4.8.0-py3-none-any.whl.metadata (3.0 kB)\n",
      "Collecting bandit==1.7.7 (from -r TensorRT-LLM/requirements-dev.txt (line 16))\n",
      "  Using cached bandit-1.7.7-py3-none-any.whl.metadata (5.9 kB)\n",
      "Collecting jsonlines==4.0.0 (from -r TensorRT-LLM/requirements-dev.txt (line 17))\n",
      "  Using cached jsonlines-4.0.0-py3-none-any.whl.metadata (1.6 kB)\n",
      "Collecting jieba==0.42.1 (from -r TensorRT-LLM/requirements-dev.txt (line 18))\n",
      "  Using cached jieba-0.42.1-py3-none-any.whl\n",
      "Collecting rouge==1.0.1 (from -r TensorRT-LLM/requirements-dev.txt (line 19))\n",
      "  Using cached rouge-1.0.1-py3-none-any.whl.metadata (4.1 kB)\n",
      "Collecting tensorrt-cu12-libs==10.1.0 (from tensorrt-cu12==10.1.0->-r TensorRT-LLM/requirements.txt (line 19))\n",
      "  Using cached https://pypi.nvidia.com/tensorrt-cu12-libs/tensorrt_cu12_libs-10.1.0-py2.py3-none-manylinux_2_17_x86_64.whl (1056.3 MB)\n",
      "Collecting tensorrt-cu12-bindings==10.1.0 (from tensorrt-cu12==10.1.0->-r TensorRT-LLM/requirements.txt (line 19))\n",
      "  Using cached https://pypi.nvidia.com/tensorrt-cu12-bindings/tensorrt_cu12_bindings-10.1.0-cp310-none-manylinux_2_17_x86_64.whl (1.1 MB)\n",
      "Collecting filelock (from datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached filelock-3.15.4-py3-none-any.whl.metadata (2.9 kB)\n",
      "Collecting pyarrow>=12.0.0 (from datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached pyarrow-16.1.0-cp310-cp310-manylinux_2_28_x86_64.whl.metadata (3.0 kB)\n",
      "Collecting pyarrow-hotfix (from datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached pyarrow_hotfix-0.6-py3-none-any.whl.metadata (3.6 kB)\n",
      "Collecting dill<0.3.9,>=0.3.0 (from datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached dill-0.3.8-py3-none-any.whl.metadata (10 kB)\n",
      "Collecting requests>=2.32.1 (from datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached requests-2.32.3-py3-none-any.whl.metadata (4.6 kB)\n",
      "Collecting tqdm>=4.62.1 (from datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached tqdm-4.66.4-py3-none-any.whl.metadata (57 kB)\n",
      "Collecting xxhash (from datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached xxhash-3.4.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (12 kB)\n",
      "Collecting multiprocess (from datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached multiprocess-0.70.16-py310-none-any.whl.metadata (7.2 kB)\n",
      "Collecting fsspec<=2024.3.1,>=2023.1.0 (from fsspec[http]<=2024.3.1,>=2023.1.0->datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached fsspec-2024.3.1-py3-none-any.whl.metadata (6.8 kB)\n",
      "Collecting aiohttp (from datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached aiohttp-3.9.5-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (7.5 kB)\n",
      "Collecting huggingface-hub>=0.21.2 (from datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached huggingface_hub-0.23.4-py3-none-any.whl.metadata (12 kB)\n",
      "Collecting packaging (from datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached packaging-24.1-py3-none-any.whl.metadata (3.2 kB)\n",
      "Collecting pyyaml>=5.1 (from datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached PyYAML-6.0.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (2.1 kB)\n",
      "Collecting stevedore>=1.20.0 (from bandit==1.7.7->-r TensorRT-LLM/requirements-dev.txt (line 16))\n",
      "  Using cached stevedore-5.2.0-py3-none-any.whl.metadata (2.3 kB)\n",
      "Collecting rich (from bandit==1.7.7->-r TensorRT-LLM/requirements-dev.txt (line 16))\n",
      "  Using cached rich-13.7.1-py3-none-any.whl.metadata (18 kB)\n",
      "Collecting attrs>=19.2.0 (from jsonlines==4.0.0->-r TensorRT-LLM/requirements-dev.txt (line 17))\n",
      "  Using cached attrs-23.2.0-py3-none-any.whl.metadata (9.5 kB)\n",
      "Collecting six (from rouge==1.0.1->-r TensorRT-LLM/requirements-dev.txt (line 19))\n",
      "  Using cached six-1.16.0-py2.py3-none-any.whl.metadata (1.8 kB)\n",
      "Collecting nvidia-cuda-runtime-cu12 (from tensorrt-cu12-libs==10.1.0->tensorrt-cu12==10.1.0->-r TensorRT-LLM/requirements.txt (line 19))\n",
      "  Using cached https://pypi.nvidia.com/nvidia-cuda-runtime-cu12/nvidia_cuda_runtime_cu12-12.5.82-py3-none-manylinux2014_x86_64.whl (895 kB)\n",
      "Collecting safetensors>=0.3.1 (from accelerate>=0.25.0->-r TensorRT-LLM/requirements.txt (line 2))\n",
      "  Using cached safetensors-0.4.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (3.8 kB)\n",
      "Collecting pyproject_hooks (from build->-r TensorRT-LLM/requirements.txt (line 3))\n",
      "  Using cached pyproject_hooks-1.1.0-py3-none-any.whl.metadata (1.3 kB)\n",
      "Collecting tomli>=1.1.0 (from build->-r TensorRT-LLM/requirements.txt (line 3))\n",
      "  Using cached tomli-2.0.1-py3-none-any.whl.metadata (8.9 kB)\n",
      "Collecting importlib-metadata (from diffusers>=0.27.0->-r TensorRT-LLM/requirements.txt (line 6))\n",
      "  Using cached importlib_metadata-8.0.0-py3-none-any.whl.metadata (4.6 kB)\n",
      "Collecting regex!=2019.12.17 (from diffusers>=0.27.0->-r TensorRT-LLM/requirements.txt (line 6))\n",
      "  Using cached regex-2024.5.15-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (40 kB)\n",
      "Collecting protobuf>=3.20.2 (from onnx>=1.12.0->-r TensorRT-LLM/requirements.txt (line 10))\n",
      "  Using cached protobuf-5.27.2-cp38-abi3-manylinux2014_x86_64.whl.metadata (592 bytes)\n",
      "Collecting python-dateutil>=2.8.2 (from pandas->-r TensorRT-LLM/requirements.txt (line 15))\n",
      "  Using cached python_dateutil-2.9.0.post0-py2.py3-none-any.whl.metadata (8.4 kB)\n",
      "Collecting pytz>=2020.1 (from pandas->-r TensorRT-LLM/requirements.txt (line 15))\n",
      "  Using cached pytz-2024.1-py2.py3-none-any.whl.metadata (22 kB)\n",
      "Collecting tzdata>=2022.7 (from pandas->-r TensorRT-LLM/requirements.txt (line 15))\n",
      "  Using cached tzdata-2024.1-py2.py3-none-any.whl.metadata (1.4 kB)\n",
      "Collecting sympy (from torch<=2.4.0a0,>=2.3.0a0->-r TensorRT-LLM/requirements.txt (line 23))\n",
      "  Using cached sympy-1.13.0-py3-none-any.whl.metadata (12 kB)\n",
      "Collecting networkx (from torch<=2.4.0a0,>=2.3.0a0->-r TensorRT-LLM/requirements.txt (line 23))\n",
      "  Using cached networkx-3.3-py3-none-any.whl.metadata (5.1 kB)\n",
      "Collecting jinja2 (from torch<=2.4.0a0,>=2.3.0a0->-r TensorRT-LLM/requirements.txt (line 23))\n",
      "  Using cached jinja2-3.1.4-py3-none-any.whl.metadata (2.6 kB)\n",
      "Collecting nvidia-cuda-nvrtc-cu12==12.1.105 (from torch<=2.4.0a0,>=2.3.0a0->-r TensorRT-LLM/requirements.txt (line 23))\n",
      "  Using cached https://pypi.nvidia.com/nvidia-cuda-nvrtc-cu12/nvidia_cuda_nvrtc_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (23.7 MB)\n",
      "Collecting nvidia-cuda-runtime-cu12 (from tensorrt-cu12-libs==10.1.0->tensorrt-cu12==10.1.0->-r TensorRT-LLM/requirements.txt (line 19))\n",
      "  Using cached https://pypi.nvidia.com/nvidia-cuda-runtime-cu12/nvidia_cuda_runtime_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (823 kB)\n",
      "Collecting nvidia-cuda-cupti-cu12==12.1.105 (from torch<=2.4.0a0,>=2.3.0a0->-r TensorRT-LLM/requirements.txt (line 23))\n",
      "  Using cached https://pypi.nvidia.com/nvidia-cuda-cupti-cu12/nvidia_cuda_cupti_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (14.1 MB)\n",
      "Collecting nvidia-cudnn-cu12==8.9.2.26 (from torch<=2.4.0a0,>=2.3.0a0->-r TensorRT-LLM/requirements.txt (line 23))\n",
      "  Using cached https://pypi.nvidia.com/nvidia-cudnn-cu12/nvidia_cudnn_cu12-8.9.2.26-py3-none-manylinux1_x86_64.whl (731.7 MB)\n",
      "Collecting nvidia-cublas-cu12==12.1.3.1 (from torch<=2.4.0a0,>=2.3.0a0->-r TensorRT-LLM/requirements.txt (line 23))\n",
      "  Using cached https://pypi.nvidia.com/nvidia-cublas-cu12/nvidia_cublas_cu12-12.1.3.1-py3-none-manylinux1_x86_64.whl (410.6 MB)\n",
      "Collecting nvidia-cufft-cu12==11.0.2.54 (from torch<=2.4.0a0,>=2.3.0a0->-r TensorRT-LLM/requirements.txt (line 23))\n",
      "  Using cached https://pypi.nvidia.com/nvidia-cufft-cu12/nvidia_cufft_cu12-11.0.2.54-py3-none-manylinux1_x86_64.whl (121.6 MB)\n",
      "Collecting nvidia-curand-cu12==10.3.2.106 (from torch<=2.4.0a0,>=2.3.0a0->-r TensorRT-LLM/requirements.txt (line 23))\n",
      "  Using cached https://pypi.nvidia.com/nvidia-curand-cu12/nvidia_curand_cu12-10.3.2.106-py3-none-manylinux1_x86_64.whl (56.5 MB)\n",
      "Collecting nvidia-cusolver-cu12==11.4.5.107 (from torch<=2.4.0a0,>=2.3.0a0->-r TensorRT-LLM/requirements.txt (line 23))\n",
      "  Using cached https://pypi.nvidia.com/nvidia-cusolver-cu12/nvidia_cusolver_cu12-11.4.5.107-py3-none-manylinux1_x86_64.whl (124.2 MB)\n",
      "Collecting nvidia-cusparse-cu12==12.1.0.106 (from torch<=2.4.0a0,>=2.3.0a0->-r TensorRT-LLM/requirements.txt (line 23))\n",
      "  Using cached https://pypi.nvidia.com/nvidia-cusparse-cu12/nvidia_cusparse_cu12-12.1.0.106-py3-none-manylinux1_x86_64.whl (196.0 MB)\n",
      "Collecting nvidia-nccl-cu12==2.20.5 (from torch<=2.4.0a0,>=2.3.0a0->-r TensorRT-LLM/requirements.txt (line 23))\n",
      "  Using cached https://pypi.nvidia.com/nvidia-nccl-cu12/nvidia_nccl_cu12-2.20.5-py3-none-manylinux2014_x86_64.whl (176.2 MB)\n",
      "Collecting nvidia-nvtx-cu12==12.1.105 (from torch<=2.4.0a0,>=2.3.0a0->-r TensorRT-LLM/requirements.txt (line 23))\n",
      "  Using cached https://pypi.nvidia.com/nvidia-nvtx-cu12/nvidia_nvtx_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (99 kB)\n",
      "Collecting triton==2.3.1 (from torch<=2.4.0a0,>=2.3.0a0->-r TensorRT-LLM/requirements.txt (line 23))\n",
      "  Using cached triton-2.3.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (1.4 kB)\n",
      "Collecting nvidia-nvjitlink-cu12 (from nvidia-cusolver-cu12==11.4.5.107->torch<=2.4.0a0,>=2.3.0a0->-r TensorRT-LLM/requirements.txt (line 23))\n",
      "  Using cached https://pypi.nvidia.com/nvidia-nvjitlink-cu12/nvidia_nvjitlink_cu12-12.5.82-py3-none-manylinux2014_x86_64.whl (21.3 MB)\n",
      "Collecting ninja (from nvidia-modelopt<0.14,~=0.13->-r TensorRT-LLM/requirements.txt (line 24))\n",
      "  Using cached ninja-1.11.1.1-py2.py3-none-manylinux1_x86_64.manylinux_2_5_x86_64.whl.metadata (5.3 kB)\n",
      "Collecting pydantic>=2.0 (from nvidia-modelopt<0.14,~=0.13->-r TensorRT-LLM/requirements.txt (line 24))\n",
      "  Using cached pydantic-2.8.2-py3-none-any.whl.metadata (125 kB)\n",
      "Collecting scipy (from nvidia-modelopt<0.14,~=0.13->-r TensorRT-LLM/requirements.txt (line 24))\n",
      "  Using cached scipy-1.14.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (60 kB)\n",
      "Collecting tokenizers<0.20,>=0.19 (from transformers>=4.38.2->-r TensorRT-LLM/requirements.txt (line 25))\n",
      "  Using cached tokenizers-0.19.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (6.7 kB)\n",
      "Collecting coloredlogs (from optimum->-r TensorRT-LLM/requirements.txt (line 28))\n",
      "  Using cached coloredlogs-15.0.1-py2.py3-none-any.whl.metadata (12 kB)\n",
      "Collecting mypy-extensions>=1.0.0 (from mypy->-r TensorRT-LLM/requirements-dev.txt (line 5))\n",
      "  Using cached mypy_extensions-1.0.0-py3-none-any.whl.metadata (1.1 kB)\n",
      "Collecting cfgv>=2.0.0 (from pre-commit->-r TensorRT-LLM/requirements-dev.txt (line 7))\n",
      "  Using cached cfgv-3.4.0-py2.py3-none-any.whl.metadata (8.5 kB)\n",
      "Collecting identify>=1.0.0 (from pre-commit->-r TensorRT-LLM/requirements-dev.txt (line 7))\n",
      "  Using cached identify-2.6.0-py2.py3-none-any.whl.metadata (4.4 kB)\n",
      "Collecting nodeenv>=0.11.1 (from pre-commit->-r TensorRT-LLM/requirements-dev.txt (line 7))\n",
      "  Using cached nodeenv-1.9.1-py2.py3-none-any.whl.metadata (21 kB)\n",
      "Collecting virtualenv>=20.10.0 (from pre-commit->-r TensorRT-LLM/requirements-dev.txt (line 7))\n",
      "  Using cached virtualenv-20.26.3-py3-none-any.whl.metadata (4.5 kB)\n",
      "Collecting pytest>=4.6 (from pytest-cov->-r TensorRT-LLM/requirements-dev.txt (line 10))\n",
      "  Using cached pytest-8.2.2-py3-none-any.whl.metadata (7.6 kB)\n",
      "Collecting coverage>=5.2.1 (from coverage[toml]>=5.2.1->pytest-cov->-r TensorRT-LLM/requirements-dev.txt (line 10))\n",
      "  Using cached coverage-7.6.0-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (8.2 kB)\n",
      "Collecting py (from pytest-forked->-r TensorRT-LLM/requirements-dev.txt (line 11))\n",
      "  Using cached py-1.11.0-py2.py3-none-any.whl.metadata (2.8 kB)\n",
      "Collecting execnet>=2.1 (from pytest-xdist->-r TensorRT-LLM/requirements-dev.txt (line 12))\n",
      "  Using cached execnet-2.1.1-py3-none-any.whl.metadata (2.9 kB)\n",
      "Collecting absl-py (from rouge_score->-r TensorRT-LLM/requirements-dev.txt (line 13))\n",
      "  Using cached absl_py-2.1.0-py3-none-any.whl.metadata (2.3 kB)\n",
      "Collecting nltk (from rouge_score->-r TensorRT-LLM/requirements-dev.txt (line 13))\n",
      "  Using cached nltk-3.8.1-py3-none-any.whl.metadata (2.8 kB)\n",
      "Collecting aiosignal>=1.1.2 (from aiohttp->datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached aiosignal-1.3.1-py3-none-any.whl.metadata (4.0 kB)\n",
      "Collecting frozenlist>=1.1.1 (from aiohttp->datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached frozenlist-1.4.1-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (12 kB)\n",
      "Collecting multidict<7.0,>=4.5 (from aiohttp->datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached multidict-6.0.5-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)\n",
      "Collecting yarl<2.0,>=1.0 (from aiohttp->datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached yarl-1.9.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (31 kB)\n",
      "Collecting async-timeout<5.0,>=4.0 (from aiohttp->datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached async_timeout-4.0.3-py3-none-any.whl.metadata (4.2 kB)\n",
      "Collecting annotated-types>=0.4.0 (from pydantic>=2.0->nvidia-modelopt<0.14,~=0.13->-r TensorRT-LLM/requirements.txt (line 24))\n",
      "  Using cached annotated_types-0.7.0-py3-none-any.whl.metadata (15 kB)\n",
      "Collecting pydantic-core==2.20.1 (from pydantic>=2.0->nvidia-modelopt<0.14,~=0.13->-r TensorRT-LLM/requirements.txt (line 24))\n",
      "  Using cached pydantic_core-2.20.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (6.6 kB)\n",
      "Collecting iniconfig (from pytest>=4.6->pytest-cov->-r TensorRT-LLM/requirements-dev.txt (line 10))\n",
      "  Using cached iniconfig-2.0.0-py3-none-any.whl.metadata (2.6 kB)\n",
      "Collecting pluggy<2.0,>=1.5 (from pytest>=4.6->pytest-cov->-r TensorRT-LLM/requirements-dev.txt (line 10))\n",
      "  Using cached pluggy-1.5.0-py3-none-any.whl.metadata (4.8 kB)\n",
      "Collecting exceptiongroup>=1.0.0rc8 (from pytest>=4.6->pytest-cov->-r TensorRT-LLM/requirements-dev.txt (line 10))\n",
      "  Using cached exceptiongroup-1.2.2-py3-none-any.whl.metadata (6.6 kB)\n",
      "Collecting charset-normalizer<4,>=2 (from requests>=2.32.1->datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached charset_normalizer-3.3.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (33 kB)\n",
      "Collecting idna<4,>=2.5 (from requests>=2.32.1->datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached idna-3.7-py3-none-any.whl.metadata (9.9 kB)\n",
      "Collecting urllib3<3,>=1.21.1 (from requests>=2.32.1->datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached urllib3-2.2.2-py3-none-any.whl.metadata (6.4 kB)\n",
      "Collecting certifi>=2017.4.17 (from requests>=2.32.1->datasets==2.19.2->-r TensorRT-LLM/requirements-dev.txt (line 2))\n",
      "  Using cached certifi-2024.7.4-py3-none-any.whl.metadata (2.2 kB)\n",
      "Collecting pbr!=2.1.0,>=2.0.0 (from stevedore>=1.20.0->bandit==1.7.7->-r TensorRT-LLM/requirements-dev.txt (line 16))\n",
      "  Using cached pbr-6.0.0-py2.py3-none-any.whl.metadata (1.3 kB)\n",
      "Collecting distlib<1,>=0.3.7 (from virtualenv>=20.10.0->pre-commit->-r TensorRT-LLM/requirements-dev.txt (line 7))\n",
      "  Using cached distlib-0.3.8-py2.py3-none-any.whl.metadata (5.1 kB)\n",
      "Collecting platformdirs<5,>=3.9.1 (from virtualenv>=20.10.0->pre-commit->-r TensorRT-LLM/requirements-dev.txt (line 7))\n",
      "  Using cached platformdirs-4.2.2-py3-none-any.whl.metadata (11 kB)\n",
      "Collecting humanfriendly>=9.1 (from coloredlogs->optimum->-r TensorRT-LLM/requirements.txt (line 28))\n",
      "  Using cached humanfriendly-10.0-py2.py3-none-any.whl.metadata (9.2 kB)\n",
      "Collecting zipp>=0.5 (from importlib-metadata->diffusers>=0.27.0->-r TensorRT-LLM/requirements.txt (line 6))\n",
      "  Using cached zipp-3.19.2-py3-none-any.whl.metadata (3.6 kB)\n",
      "Collecting MarkupSafe>=2.0 (from jinja2->torch<=2.4.0a0,>=2.3.0a0->-r TensorRT-LLM/requirements.txt (line 23))\n",
      "  Using cached MarkupSafe-2.1.5-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (3.0 kB)\n",
      "Collecting click (from nltk->rouge_score->-r TensorRT-LLM/requirements-dev.txt (line 13))\n",
      "  Using cached click-8.1.7-py3-none-any.whl.metadata (3.0 kB)\n",
      "Collecting joblib (from nltk->rouge_score->-r TensorRT-LLM/requirements-dev.txt (line 13))\n",
      "  Using cached joblib-1.4.2-py3-none-any.whl.metadata (5.4 kB)\n",
      "Collecting markdown-it-py>=2.2.0 (from rich->bandit==1.7.7->-r TensorRT-LLM/requirements-dev.txt (line 16))\n",
      "  Using cached markdown_it_py-3.0.0-py3-none-any.whl.metadata (6.9 kB)\n",
      "Collecting pygments<3.0.0,>=2.13.0 (from rich->bandit==1.7.7->-r TensorRT-LLM/requirements-dev.txt (line 16))\n",
      "  Using cached pygments-2.18.0-py3-none-any.whl.metadata (2.5 kB)\n",
      "Collecting mdurl~=0.1 (from markdown-it-py>=2.2.0->rich->bandit==1.7.7->-r TensorRT-LLM/requirements-dev.txt (line 16))\n",
      "  Using cached mdurl-0.1.2-py3-none-any.whl.metadata (1.6 kB)\n",
      "Using cached h5py-3.10.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (4.8 MB)\n",
      "Using cached pillow-10.3.0-cp310-cp310-manylinux_2_28_x86_64.whl (4.5 MB)\n",
      "Using cached datasets-2.19.2-py3-none-any.whl (542 kB)\n",
      "Using cached typing_extensions-4.8.0-py3-none-any.whl (31 kB)\n",
      "Using cached bandit-1.7.7-py3-none-any.whl (124 kB)\n",
      "Using cached jsonlines-4.0.0-py3-none-any.whl (8.7 kB)\n",
      "Using cached rouge-1.0.1-py3-none-any.whl (13 kB)\n",
      "Using cached accelerate-0.32.1-py3-none-any.whl (314 kB)\n",
      "Using cached build-1.2.1-py3-none-any.whl (21 kB)\n",
      "Using cached colored-2.2.4-py3-none-any.whl (16 kB)\n",
      "Using cached cuda_python-12.5.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (24.8 MB)\n",
      "Using cached diffusers-0.29.2-py3-none-any.whl (2.2 MB)\n",
      "Using cached lark-1.1.9-py3-none-any.whl (111 kB)\n",
      "Using cached numpy-1.26.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (18.2 MB)\n",
      "Using cached onnx-1.16.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (15.9 MB)\n",
      "Using cached psutil-6.0.0-cp36-abi3-manylinux_2_12_x86_64.manylinux2010_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (290 kB)\n",
      "Using cached pynvml-11.5.2-py3-none-any.whl (53 kB)\n",
      "Using cached PuLP-2.9.0-py3-none-any.whl (17.7 MB)\n",
      "Using cached pandas-2.2.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (13.0 MB)\n",
      "Using cached StrEnum-0.4.15-py3-none-any.whl (8.9 kB)\n",
      "Using cached sentencepiece-0.2.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)\n",
      "Using cached torch-2.3.1-cp310-cp310-manylinux1_x86_64.whl (779.1 MB)\n",
      "Using cached triton-2.3.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (168.1 MB)\n",
      "Using cached transformers-4.42.4-py3-none-any.whl (9.3 MB)\n",
      "Using cached wheel-0.43.0-py3-none-any.whl (65 kB)\n",
      "Using cached optimum-1.21.2-py3-none-any.whl (424 kB)\n",
      "Using cached evaluate-0.4.2-py3-none-any.whl (84 kB)\n",
      "Using cached janus-1.0.0-py3-none-any.whl (6.9 kB)\n",
      "Using cached mpmath-1.3.0-py3-none-any.whl (536 kB)\n",
      "Using cached einops-0.8.0-py3-none-any.whl (43 kB)\n",
      "Using cached graphviz-0.20.3-py3-none-any.whl (47 kB)\n",
      "Using cached mypy-1.10.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (12.7 MB)\n",
      "Using cached parameterized-0.9.0-py2.py3-none-any.whl (20 kB)\n",
      "Using cached pre_commit-3.7.1-py2.py3-none-any.whl (204 kB)\n",
      "Using cached pybind11-2.13.1-py3-none-any.whl (238 kB)\n",
      "Using cached pybind11_stubgen-2.5.1-py3-none-any.whl (29 kB)\n",
      "Using cached pytest_cov-5.0.0-py3-none-any.whl (21 kB)\n",
      "Using cached pytest_forked-1.6.0-py3-none-any.whl (4.9 kB)\n",
      "Using cached pytest_xdist-3.6.1-py3-none-any.whl (46 kB)\n",
      "Using cached cloudpickle-3.0.0-py3-none-any.whl (20 kB)\n",
      "Using cached attrs-23.2.0-py3-none-any.whl (60 kB)\n",
      "Using cached cfgv-3.4.0-py2.py3-none-any.whl (7.2 kB)\n",
      "Using cached coverage-7.6.0-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (233 kB)\n",
      "Using cached dill-0.3.8-py3-none-any.whl (116 kB)\n",
      "Using cached execnet-2.1.1-py3-none-any.whl (40 kB)\n",
      "Using cached fsspec-2024.3.1-py3-none-any.whl (171 kB)\n",
      "Using cached aiohttp-3.9.5-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.2 MB)\n",
      "Using cached huggingface_hub-0.23.4-py3-none-any.whl (402 kB)\n",
      "Using cached identify-2.6.0-py2.py3-none-any.whl (98 kB)\n",
      "Using cached mypy_extensions-1.0.0-py3-none-any.whl (4.7 kB)\n",
      "Using cached nodeenv-1.9.1-py2.py3-none-any.whl (22 kB)\n",
      "Using cached packaging-24.1-py3-none-any.whl (53 kB)\n",
      "Using cached protobuf-5.27.2-cp38-abi3-manylinux2014_x86_64.whl (309 kB)\n",
      "Using cached pyarrow-16.1.0-cp310-cp310-manylinux_2_28_x86_64.whl (40.8 MB)\n",
      "Using cached pydantic-2.8.2-py3-none-any.whl (423 kB)\n",
      "Using cached pydantic_core-2.20.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.1 MB)\n",
      "Using cached pytest-8.2.2-py3-none-any.whl (339 kB)\n",
      "Using cached python_dateutil-2.9.0.post0-py2.py3-none-any.whl (229 kB)\n",
      "Using cached pytz-2024.1-py2.py3-none-any.whl (505 kB)\n",
      "Using cached PyYAML-6.0.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (705 kB)\n",
      "Using cached regex-2024.5.15-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (775 kB)\n",
      "Using cached requests-2.32.3-py3-none-any.whl (64 kB)\n",
      "Using cached safetensors-0.4.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.2 MB)\n",
      "Using cached six-1.16.0-py2.py3-none-any.whl (11 kB)\n",
      "Using cached stevedore-5.2.0-py3-none-any.whl (49 kB)\n",
      "Using cached tokenizers-0.19.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.6 MB)\n",
      "Using cached tomli-2.0.1-py3-none-any.whl (12 kB)\n",
      "Using cached tqdm-4.66.4-py3-none-any.whl (78 kB)\n",
      "Using cached tzdata-2024.1-py2.py3-none-any.whl (345 kB)\n",
      "Using cached virtualenv-20.26.3-py3-none-any.whl (5.7 MB)\n",
      "Using cached filelock-3.15.4-py3-none-any.whl (16 kB)\n",
      "Using cached absl_py-2.1.0-py3-none-any.whl (133 kB)\n",
      "Using cached coloredlogs-15.0.1-py2.py3-none-any.whl (46 kB)\n",
      "Using cached importlib_metadata-8.0.0-py3-none-any.whl (24 kB)\n",
      "Using cached jinja2-3.1.4-py3-none-any.whl (133 kB)\n",
      "Using cached multiprocess-0.70.16-py310-none-any.whl (134 kB)\n",
      "Using cached networkx-3.3-py3-none-any.whl (1.7 MB)\n",
      "Using cached ninja-1.11.1.1-py2.py3-none-manylinux1_x86_64.manylinux_2_5_x86_64.whl (307 kB)\n",
      "Using cached nltk-3.8.1-py3-none-any.whl (1.5 MB)\n",
      "Using cached py-1.11.0-py2.py3-none-any.whl (98 kB)\n",
      "Using cached pyarrow_hotfix-0.6-py3-none-any.whl (7.9 kB)\n",
      "Using cached pyproject_hooks-1.1.0-py3-none-any.whl (9.2 kB)\n",
      "Using cached rich-13.7.1-py3-none-any.whl (240 kB)\n",
      "Using cached scipy-1.14.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (41.1 MB)\n",
      "Using cached sympy-1.13.0-py3-none-any.whl (6.2 MB)\n",
      "Using cached xxhash-3.4.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (194 kB)\n",
      "Using cached aiosignal-1.3.1-py3-none-any.whl (7.6 kB)\n",
      "Using cached annotated_types-0.7.0-py3-none-any.whl (13 kB)\n",
      "Using cached async_timeout-4.0.3-py3-none-any.whl (5.7 kB)\n",
      "Using cached certifi-2024.7.4-py3-none-any.whl (162 kB)\n",
      "Using cached charset_normalizer-3.3.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (142 kB)\n",
      "Using cached distlib-0.3.8-py2.py3-none-any.whl (468 kB)\n",
      "Using cached exceptiongroup-1.2.2-py3-none-any.whl (16 kB)\n",
      "Using cached frozenlist-1.4.1-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (239 kB)\n",
      "Using cached humanfriendly-10.0-py2.py3-none-any.whl (86 kB)\n",
      "Using cached idna-3.7-py3-none-any.whl (66 kB)\n",
      "Using cached markdown_it_py-3.0.0-py3-none-any.whl (87 kB)\n",
      "Using cached MarkupSafe-2.1.5-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (25 kB)\n",
      "Using cached multidict-6.0.5-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (124 kB)\n",
      "Using cached pbr-6.0.0-py2.py3-none-any.whl (107 kB)\n",
      "Using cached platformdirs-4.2.2-py3-none-any.whl (18 kB)\n",
      "Using cached pluggy-1.5.0-py3-none-any.whl (20 kB)\n",
      "Using cached pygments-2.18.0-py3-none-any.whl (1.2 MB)\n",
      "Using cached urllib3-2.2.2-py3-none-any.whl (121 kB)\n",
      "Using cached yarl-1.9.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (301 kB)\n",
      "Using cached zipp-3.19.2-py3-none-any.whl (9.0 kB)\n",
      "Using cached click-8.1.7-py3-none-any.whl (97 kB)\n",
      "Using cached iniconfig-2.0.0-py3-none-any.whl (5.9 kB)\n",
      "Using cached joblib-1.4.2-py3-none-any.whl (301 kB)\n",
      "Using cached mdurl-0.1.2-py3-none-any.whl (10.0 kB)\n",
      "Installing collected packages: tensorrt-cu12-bindings, StrEnum, sentencepiece, pytz, ninja, mpmath, jieba, distlib, cuda-python, zipp, xxhash, wheel, urllib3, tzdata, typing-extensions, tqdm, tomli, sympy, six, safetensors, regex, pyyaml, pyproject_hooks, pynvml, pygments, pybind11-stubgen, pybind11, pyarrow-hotfix, py, pulp, psutil, protobuf, polygraphy, pluggy, platformdirs, pillow, pbr, parameterized, packaging, nvidia-nvtx-cu12, nvidia-nvjitlink-cu12, nvidia-nccl-cu12, nvidia-curand-cu12, nvidia-cufft-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, numpy, nodeenv, networkx, mypy-extensions, multidict, mpi4py, mdurl, MarkupSafe, lark, joblib, iniconfig, idna, identify, humanfriendly, graphviz, fsspec, frozenlist, filelock, execnet, exceptiongroup, einops, dill, coverage, colored, cloudpickle, click, charset-normalizer, cfgv, certifi, attrs, async-timeout, annotated-types, absl-py, yarl, virtualenv, triton, tensorrt-cu12-libs, stevedore, scipy, rouge, requests, python-dateutil, pytest, pydantic-core, pyarrow, onnx, nvidia-cusparse-cu12, nvidia-cudnn-cu12, nltk, mypy, multiprocess, markdown-it-py, jsonlines, jinja2, janus, importlib-metadata, h5py, coloredlogs, build, aiosignal, tensorrt-cu12, rouge_score, rich, pytest-xdist, pytest-forked, pytest-cov, pydantic, pre-commit, pandas, nvidia-cusolver-cu12, huggingface-hub, aiohttp, torch, tokenizers, nvidia-modelopt, diffusers, bandit, transformers, datasets, accelerate, evaluate, optimum\n",
      "  Attempting uninstall: tensorrt-cu12-bindings\n",
      "    Found existing installation: tensorrt-cu12-bindings 10.1.0\n",
      "    Uninstalling tensorrt-cu12-bindings-10.1.0:\n",
      "      Successfully uninstalled tensorrt-cu12-bindings-10.1.0\n",
      "  Attempting uninstall: StrEnum\n",
      "    Found existing installation: StrEnum 0.4.15\n",
      "    Uninstalling StrEnum-0.4.15:\n",
      "      Successfully uninstalled StrEnum-0.4.15\n",
      "  Attempting uninstall: sentencepiece\n",
      "    Found existing installation: sentencepiece 0.2.0\n",
      "    Uninstalling sentencepiece-0.2.0:\n",
      "      Successfully uninstalled sentencepiece-0.2.0\n",
      "  Attempting uninstall: pytz\n",
      "    Found existing installation: pytz 2024.1\n",
      "    Uninstalling pytz-2024.1:\n",
      "      Successfully uninstalled pytz-2024.1\n",
      "  Attempting uninstall: ninja\n",
      "    Found existing installation: ninja 1.11.1.1\n",
      "    Uninstalling ninja-1.11.1.1:\n",
      "      Successfully uninstalled ninja-1.11.1.1\n",
      "  Attempting uninstall: mpmath\n",
      "    Found existing installation: mpmath 1.3.0\n",
      "    Uninstalling mpmath-1.3.0:\n",
      "      Successfully uninstalled mpmath-1.3.0\n",
      "  Attempting uninstall: jieba\n",
      "    Found existing installation: jieba 0.42.1\n",
      "    Uninstalling jieba-0.42.1:\n",
      "      Successfully uninstalled jieba-0.42.1\n",
      "  Attempting uninstall: distlib\n",
      "    Found existing installation: distlib 0.3.8\n",
      "    Uninstalling distlib-0.3.8:\n",
      "      Successfully uninstalled distlib-0.3.8\n",
      "  Attempting uninstall: cuda-python\n",
      "    Found existing installation: cuda-python 12.5.0\n",
      "    Uninstalling cuda-python-12.5.0:\n",
      "      Successfully uninstalled cuda-python-12.5.0\n",
      "  Attempting uninstall: zipp\n",
      "    Found existing installation: zipp 3.19.2\n",
      "    Uninstalling zipp-3.19.2:\n",
      "      Successfully uninstalled zipp-3.19.2\n",
      "  Attempting uninstall: xxhash\n",
      "    Found existing installation: xxhash 3.4.1\n",
      "    Uninstalling xxhash-3.4.1:\n",
      "      Successfully uninstalled xxhash-3.4.1\n",
      "  Attempting uninstall: wheel\n",
      "    Found existing installation: wheel 0.43.0\n",
      "    Uninstalling wheel-0.43.0:\n",
      "      Successfully uninstalled wheel-0.43.0\n",
      "  Attempting uninstall: urllib3\n",
      "    Found existing installation: urllib3 2.2.2\n",
      "    Uninstalling urllib3-2.2.2:\n",
      "      Successfully uninstalled urllib3-2.2.2\n",
      "  Attempting uninstall: tzdata\n",
      "    Found existing installation: tzdata 2024.1\n",
      "    Uninstalling tzdata-2024.1:\n",
      "      Successfully uninstalled tzdata-2024.1\n",
      "  Attempting uninstall: typing-extensions\n",
      "    Found existing installation: typing_extensions 4.8.0\n",
      "    Uninstalling typing_extensions-4.8.0:\n",
      "      Successfully uninstalled typing_extensions-4.8.0\n",
      "  Attempting uninstall: tqdm\n",
      "    Found existing installation: tqdm 4.66.4\n",
      "    Uninstalling tqdm-4.66.4:\n",
      "      Successfully uninstalled tqdm-4.66.4\n",
      "  Attempting uninstall: tomli\n",
      "    Found existing installation: tomli 2.0.1\n",
      "    Uninstalling tomli-2.0.1:\n",
      "      Successfully uninstalled tomli-2.0.1\n",
      "  Attempting uninstall: sympy\n",
      "    Found existing installation: sympy 1.13.0\n",
      "    Uninstalling sympy-1.13.0:\n",
      "      Successfully uninstalled sympy-1.13.0\n",
      "  Attempting uninstall: six\n",
      "    Found existing installation: six 1.16.0\n",
      "    Uninstalling six-1.16.0:\n",
      "      Successfully uninstalled six-1.16.0\n",
      "  Attempting uninstall: safetensors\n",
      "    Found existing installation: safetensors 0.4.3\n",
      "    Uninstalling safetensors-0.4.3:\n",
      "      Successfully uninstalled safetensors-0.4.3\n",
      "  Attempting uninstall: regex\n",
      "    Found existing installation: regex 2024.5.15\n",
      "    Uninstalling regex-2024.5.15:\n",
      "      Successfully uninstalled regex-2024.5.15\n",
      "  Attempting uninstall: pyyaml\n",
      "    Found existing installation: PyYAML 6.0.1\n",
      "    Uninstalling PyYAML-6.0.1:\n",
      "      Successfully uninstalled PyYAML-6.0.1\n",
      "  Attempting uninstall: pyproject_hooks\n",
      "    Found existing installation: pyproject_hooks 1.1.0\n",
      "    Uninstalling pyproject_hooks-1.1.0:\n",
      "      Successfully uninstalled pyproject_hooks-1.1.0\n",
      "  Attempting uninstall: pynvml\n",
      "    Found existing installation: pynvml 11.5.2\n",
      "    Uninstalling pynvml-11.5.2:\n",
      "      Successfully uninstalled pynvml-11.5.2\n",
      "  Attempting uninstall: pygments\n",
      "    Found existing installation: Pygments 2.18.0\n",
      "    Uninstalling Pygments-2.18.0:\n",
      "      Successfully uninstalled Pygments-2.18.0\n",
      "  Attempting uninstall: pybind11-stubgen\n",
      "    Found existing installation: pybind11-stubgen 2.5.1\n",
      "    Uninstalling pybind11-stubgen-2.5.1:\n",
      "      Successfully uninstalled pybind11-stubgen-2.5.1\n",
      "  Attempting uninstall: pybind11\n",
      "    Found existing installation: pybind11 2.13.1\n",
      "    Uninstalling pybind11-2.13.1:\n",
      "      Successfully uninstalled pybind11-2.13.1\n",
      "  Attempting uninstall: pyarrow-hotfix\n",
      "    Found existing installation: pyarrow-hotfix 0.6\n",
      "    Uninstalling pyarrow-hotfix-0.6:\n",
      "      Successfully uninstalled pyarrow-hotfix-0.6\n",
      "  Attempting uninstall: py\n",
      "    Found existing installation: py 1.11.0\n",
      "    Uninstalling py-1.11.0:\n",
      "      Successfully uninstalled py-1.11.0\n",
      "  Attempting uninstall: pulp\n",
      "    Found existing installation: PuLP 2.9.0\n",
      "    Uninstalling PuLP-2.9.0:\n",
      "      Successfully uninstalled PuLP-2.9.0\n",
      "  Attempting uninstall: psutil\n",
      "    Found existing installation: psutil 6.0.0\n",
      "    Uninstalling psutil-6.0.0:\n",
      "      Successfully uninstalled psutil-6.0.0\n",
      "  Attempting uninstall: protobuf\n",
      "    Found existing installation: protobuf 5.27.2\n",
      "    Uninstalling protobuf-5.27.2:\n",
      "      Successfully uninstalled protobuf-5.27.2\n",
      "  Attempting uninstall: polygraphy\n",
      "    Found existing installation: polygraphy 0.49.9\n",
      "    Uninstalling polygraphy-0.49.9:\n",
      "      Successfully uninstalled polygraphy-0.49.9\n",
      "  Attempting uninstall: pluggy\n",
      "    Found existing installation: pluggy 1.5.0\n",
      "    Uninstalling pluggy-1.5.0:\n",
      "      Successfully uninstalled pluggy-1.5.0\n",
      "  Attempting uninstall: platformdirs\n",
      "    Found existing installation: platformdirs 4.2.2\n",
      "    Uninstalling platformdirs-4.2.2:\n",
      "      Successfully uninstalled platformdirs-4.2.2\n",
      "  Attempting uninstall: pillow\n",
      "    Found existing installation: pillow 10.3.0\n",
      "    Uninstalling pillow-10.3.0:\n",
      "      Successfully uninstalled pillow-10.3.0\n",
      "  Attempting uninstall: pbr\n",
      "    Found existing installation: pbr 6.0.0\n",
      "    Uninstalling pbr-6.0.0:\n",
      "      Successfully uninstalled pbr-6.0.0\n",
      "  Attempting uninstall: parameterized\n",
      "    Found existing installation: parameterized 0.9.0\n",
      "    Uninstalling parameterized-0.9.0:\n",
      "      Successfully uninstalled parameterized-0.9.0\n",
      "  Attempting uninstall: packaging\n",
      "    Found existing installation: packaging 24.1\n",
      "    Uninstalling packaging-24.1:\n",
      "      Successfully uninstalled packaging-24.1\n",
      "  Attempting uninstall: nvidia-nvtx-cu12\n",
      "    Found existing installation: nvidia-nvtx-cu12 12.1.105\n",
      "    Uninstalling nvidia-nvtx-cu12-12.1.105:\n",
      "      Successfully uninstalled nvidia-nvtx-cu12-12.1.105\n",
      "  Attempting uninstall: nvidia-nvjitlink-cu12\n",
      "    Found existing installation: nvidia-nvjitlink-cu12 12.5.82\n",
      "    Uninstalling nvidia-nvjitlink-cu12-12.5.82:\n",
      "      Successfully uninstalled nvidia-nvjitlink-cu12-12.5.82\n",
      "  Attempting uninstall: nvidia-nccl-cu12\n",
      "    Found existing installation: nvidia-nccl-cu12 2.20.5\n",
      "    Uninstalling nvidia-nccl-cu12-2.20.5:\n",
      "      Successfully uninstalled nvidia-nccl-cu12-2.20.5\n",
      "  Attempting uninstall: nvidia-curand-cu12\n",
      "    Found existing installation: nvidia-curand-cu12 10.3.2.106\n",
      "    Uninstalling nvidia-curand-cu12-10.3.2.106:\n",
      "      Successfully uninstalled nvidia-curand-cu12-10.3.2.106\n",
      "  Attempting uninstall: nvidia-cufft-cu12\n",
      "    Found existing installation: nvidia-cufft-cu12 11.0.2.54\n",
      "    Uninstalling nvidia-cufft-cu12-11.0.2.54:\n",
      "      Successfully uninstalled nvidia-cufft-cu12-11.0.2.54\n",
      "  Attempting uninstall: nvidia-cuda-runtime-cu12\n",
      "    Found existing installation: nvidia-cuda-runtime-cu12 12.1.105\n",
      "    Uninstalling nvidia-cuda-runtime-cu12-12.1.105:\n",
      "      Successfully uninstalled nvidia-cuda-runtime-cu12-12.1.105\n",
      "  Attempting uninstall: nvidia-cuda-nvrtc-cu12\n",
      "    Found existing installation: nvidia-cuda-nvrtc-cu12 12.1.105\n",
      "    Uninstalling nvidia-cuda-nvrtc-cu12-12.1.105:\n",
      "      Successfully uninstalled nvidia-cuda-nvrtc-cu12-12.1.105\n",
      "  Attempting uninstall: nvidia-cuda-cupti-cu12\n",
      "    Found existing installation: nvidia-cuda-cupti-cu12 12.1.105\n",
      "    Uninstalling nvidia-cuda-cupti-cu12-12.1.105:\n",
      "      Successfully uninstalled nvidia-cuda-cupti-cu12-12.1.105\n",
      "  Attempting uninstall: nvidia-cublas-cu12\n",
      "    Found existing installation: nvidia-cublas-cu12 12.1.3.1\n",
      "    Uninstalling nvidia-cublas-cu12-12.1.3.1:\n",
      "      Successfully uninstalled nvidia-cublas-cu12-12.1.3.1\n",
      "  Attempting uninstall: numpy\n",
      "    Found existing installation: numpy 1.26.4\n",
      "    Uninstalling numpy-1.26.4:\n",
      "      Successfully uninstalled numpy-1.26.4\n",
      "  Attempting uninstall: nodeenv\n",
      "    Found existing installation: nodeenv 1.9.1\n",
      "    Uninstalling nodeenv-1.9.1:\n",
      "      Successfully uninstalled nodeenv-1.9.1\n",
      "  Attempting uninstall: networkx\n",
      "    Found existing installation: networkx 3.3\n",
      "    Uninstalling networkx-3.3:\n",
      "      Successfully uninstalled networkx-3.3\n",
      "  Attempting uninstall: mypy-extensions\n",
      "    Found existing installation: mypy-extensions 1.0.0\n",
      "    Uninstalling mypy-extensions-1.0.0:\n",
      "      Successfully uninstalled mypy-extensions-1.0.0\n",
      "  Attempting uninstall: multidict\n",
      "    Found existing installation: multidict 6.0.5\n",
      "    Uninstalling multidict-6.0.5:\n",
      "      Successfully uninstalled multidict-6.0.5\n",
      "  Attempting uninstall: mpi4py\n",
      "    Found existing installation: mpi4py 3.1.6\n",
      "    Uninstalling mpi4py-3.1.6:\n",
      "      Successfully uninstalled mpi4py-3.1.6\n",
      "  Attempting uninstall: mdurl\n",
      "    Found existing installation: mdurl 0.1.2\n",
      "    Uninstalling mdurl-0.1.2:\n",
      "      Successfully uninstalled mdurl-0.1.2\n",
      "  Attempting uninstall: MarkupSafe\n",
      "    Found existing installation: MarkupSafe 2.1.5\n",
      "    Uninstalling MarkupSafe-2.1.5:\n",
      "      Successfully uninstalled MarkupSafe-2.1.5\n",
      "  Attempting uninstall: lark\n",
      "    Found existing installation: lark 1.1.9\n",
      "    Uninstalling lark-1.1.9:\n",
      "      Successfully uninstalled lark-1.1.9\n",
      "  Attempting uninstall: joblib\n",
      "    Found existing installation: joblib 1.4.2\n",
      "    Uninstalling joblib-1.4.2:\n",
      "      Successfully uninstalled joblib-1.4.2\n",
      "  Attempting uninstall: iniconfig\n",
      "    Found existing installation: iniconfig 2.0.0\n",
      "    Uninstalling iniconfig-2.0.0:\n",
      "      Successfully uninstalled iniconfig-2.0.0\n",
      "  Attempting uninstall: idna\n",
      "    Found existing installation: idna 3.7\n",
      "    Uninstalling idna-3.7:\n",
      "      Successfully uninstalled idna-3.7\n",
      "  Attempting uninstall: identify\n",
      "    Found existing installation: identify 2.6.0\n",
      "    Uninstalling identify-2.6.0:\n",
      "      Successfully uninstalled identify-2.6.0\n",
      "  Attempting uninstall: humanfriendly\n",
      "    Found existing installation: humanfriendly 10.0\n",
      "    Uninstalling humanfriendly-10.0:\n",
      "      Successfully uninstalled humanfriendly-10.0\n",
      "  Attempting uninstall: graphviz\n",
      "    Found existing installation: graphviz 0.20.3\n",
      "    Uninstalling graphviz-0.20.3:\n",
      "      Successfully uninstalled graphviz-0.20.3\n",
      "  Attempting uninstall: fsspec\n",
      "    Found existing installation: fsspec 2024.3.1\n",
      "    Uninstalling fsspec-2024.3.1:\n",
      "      Successfully uninstalled fsspec-2024.3.1\n",
      "  Attempting uninstall: frozenlist\n",
      "    Found existing installation: frozenlist 1.4.1\n",
      "    Uninstalling frozenlist-1.4.1:\n",
      "      Successfully uninstalled frozenlist-1.4.1\n",
      "  Attempting uninstall: filelock\n",
      "    Found existing installation: filelock 3.15.4\n",
      "    Uninstalling filelock-3.15.4:\n",
      "      Successfully uninstalled filelock-3.15.4\n",
      "  Attempting uninstall: execnet\n",
      "    Found existing installation: execnet 2.1.1\n",
      "    Uninstalling execnet-2.1.1:\n",
      "      Successfully uninstalled execnet-2.1.1\n",
      "  Attempting uninstall: exceptiongroup\n",
      "    Found existing installation: exceptiongroup 1.2.2\n",
      "    Uninstalling exceptiongroup-1.2.2:\n",
      "      Successfully uninstalled exceptiongroup-1.2.2\n",
      "  Attempting uninstall: einops\n",
      "    Found existing installation: einops 0.8.0\n",
      "    Uninstalling einops-0.8.0:\n",
      "      Successfully uninstalled einops-0.8.0\n",
      "  Attempting uninstall: dill\n",
      "    Found existing installation: dill 0.3.8\n",
      "    Uninstalling dill-0.3.8:\n",
      "      Successfully uninstalled dill-0.3.8\n",
      "  Attempting uninstall: coverage\n",
      "    Found existing installation: coverage 7.6.0\n",
      "    Uninstalling coverage-7.6.0:\n",
      "      Successfully uninstalled coverage-7.6.0\n",
      "  Attempting uninstall: colored\n",
      "    Found existing installation: colored 2.2.4\n",
      "    Uninstalling colored-2.2.4:\n",
      "      Successfully uninstalled colored-2.2.4\n",
      "  Attempting uninstall: cloudpickle\n",
      "    Found existing installation: cloudpickle 3.0.0\n",
      "    Uninstalling cloudpickle-3.0.0:\n",
      "      Successfully uninstalled cloudpickle-3.0.0\n",
      "  Attempting uninstall: click\n",
      "    Found existing installation: click 8.1.7\n",
      "    Uninstalling click-8.1.7:\n",
      "      Successfully uninstalled click-8.1.7\n",
      "  Attempting uninstall: charset-normalizer\n",
      "    Found existing installation: charset-normalizer 3.3.2\n",
      "    Uninstalling charset-normalizer-3.3.2:\n",
      "      Successfully uninstalled charset-normalizer-3.3.2\n",
      "  Attempting uninstall: cfgv\n",
      "    Found existing installation: cfgv 3.4.0\n",
      "    Uninstalling cfgv-3.4.0:\n",
      "      Successfully uninstalled cfgv-3.4.0\n",
      "  Attempting uninstall: certifi\n",
      "    Found existing installation: certifi 2024.7.4\n",
      "    Uninstalling certifi-2024.7.4:\n",
      "      Successfully uninstalled certifi-2024.7.4\n",
      "  Attempting uninstall: attrs\n",
      "    Found existing installation: attrs 23.2.0\n",
      "    Uninstalling attrs-23.2.0:\n",
      "      Successfully uninstalled attrs-23.2.0\n",
      "  Attempting uninstall: async-timeout\n",
      "    Found existing installation: async-timeout 4.0.3\n",
      "    Uninstalling async-timeout-4.0.3:\n",
      "      Successfully uninstalled async-timeout-4.0.3\n",
      "  Attempting uninstall: annotated-types\n",
      "    Found existing installation: annotated-types 0.7.0\n",
      "    Uninstalling annotated-types-0.7.0:\n",
      "      Successfully uninstalled annotated-types-0.7.0\n",
      "  Attempting uninstall: absl-py\n",
      "    Found existing installation: absl-py 2.1.0\n",
      "    Uninstalling absl-py-2.1.0:\n",
      "      Successfully uninstalled absl-py-2.1.0\n",
      "  Attempting uninstall: yarl\n",
      "    Found existing installation: yarl 1.9.4\n",
      "    Uninstalling yarl-1.9.4:\n",
      "      Successfully uninstalled yarl-1.9.4\n",
      "  Attempting uninstall: virtualenv\n",
      "    Found existing installation: virtualenv 20.26.3\n",
      "    Uninstalling virtualenv-20.26.3:\n",
      "      Successfully uninstalled virtualenv-20.26.3\n",
      "  Attempting uninstall: triton\n",
      "    Found existing installation: triton 2.3.1\n",
      "    Uninstalling triton-2.3.1:\n",
      "      Successfully uninstalled triton-2.3.1\n",
      "  Attempting uninstall: tensorrt-cu12-libs\n",
      "    Found existing installation: tensorrt-cu12-libs 10.1.0\n",
      "    Uninstalling tensorrt-cu12-libs-10.1.0:\n",
      "      Successfully uninstalled tensorrt-cu12-libs-10.1.0\n",
      "  Attempting uninstall: stevedore\n",
      "    Found existing installation: stevedore 5.2.0\n",
      "    Uninstalling stevedore-5.2.0:\n",
      "      Successfully uninstalled stevedore-5.2.0\n",
      "  Attempting uninstall: scipy\n",
      "    Found existing installation: scipy 1.14.0\n",
      "    Uninstalling scipy-1.14.0:\n",
      "      Successfully uninstalled scipy-1.14.0\n",
      "  Attempting uninstall: rouge\n",
      "    Found existing installation: rouge 1.0.1\n",
      "    Uninstalling rouge-1.0.1:\n",
      "      Successfully uninstalled rouge-1.0.1\n",
      "  Attempting uninstall: requests\n",
      "    Found existing installation: requests 2.32.3\n",
      "    Uninstalling requests-2.32.3:\n",
      "      Successfully uninstalled requests-2.32.3\n",
      "  Attempting uninstall: python-dateutil\n",
      "    Found existing installation: python-dateutil 2.9.0.post0\n",
      "    Uninstalling python-dateutil-2.9.0.post0:\n",
      "      Successfully uninstalled python-dateutil-2.9.0.post0\n",
      "  Attempting uninstall: pytest\n",
      "    Found existing installation: pytest 8.2.2\n",
      "    Uninstalling pytest-8.2.2:\n",
      "      Successfully uninstalled pytest-8.2.2\n",
      "  Attempting uninstall: pydantic-core\n",
      "    Found existing installation: pydantic_core 2.20.1\n",
      "    Uninstalling pydantic_core-2.20.1:\n",
      "      Successfully uninstalled pydantic_core-2.20.1\n",
      "  Attempting uninstall: pyarrow\n",
      "    Found existing installation: pyarrow 16.1.0\n",
      "    Uninstalling pyarrow-16.1.0:\n",
      "      Successfully uninstalled pyarrow-16.1.0\n",
      "  Attempting uninstall: onnx\n",
      "    Found existing installation: onnx 1.16.1\n",
      "    Uninstalling onnx-1.16.1:\n",
      "      Successfully uninstalled onnx-1.16.1\n",
      "  Attempting uninstall: nvidia-cusparse-cu12\n",
      "    Found existing installation: nvidia-cusparse-cu12 12.1.0.106\n",
      "    Uninstalling nvidia-cusparse-cu12-12.1.0.106:\n",
      "      Successfully uninstalled nvidia-cusparse-cu12-12.1.0.106\n",
      "  Attempting uninstall: nvidia-cudnn-cu12\n",
      "    Found existing installation: nvidia-cudnn-cu12 8.9.2.26\n",
      "    Uninstalling nvidia-cudnn-cu12-8.9.2.26:\n",
      "      Successfully uninstalled nvidia-cudnn-cu12-8.9.2.26\n",
      "  Attempting uninstall: nltk\n",
      "    Found existing installation: nltk 3.8.1\n",
      "    Uninstalling nltk-3.8.1:\n",
      "      Successfully uninstalled nltk-3.8.1\n",
      "  Attempting uninstall: mypy\n",
      "    Found existing installation: mypy 1.10.1\n",
      "    Uninstalling mypy-1.10.1:\n",
      "      Successfully uninstalled mypy-1.10.1\n",
      "  Attempting uninstall: multiprocess\n",
      "    Found existing installation: multiprocess 0.70.16\n",
      "    Uninstalling multiprocess-0.70.16:\n",
      "      Successfully uninstalled multiprocess-0.70.16\n",
      "  Attempting uninstall: markdown-it-py\n",
      "    Found existing installation: markdown-it-py 3.0.0\n",
      "    Uninstalling markdown-it-py-3.0.0:\n",
      "      Successfully uninstalled markdown-it-py-3.0.0\n",
      "  Attempting uninstall: jsonlines\n",
      "    Found existing installation: jsonlines 4.0.0\n",
      "    Uninstalling jsonlines-4.0.0:\n",
      "      Successfully uninstalled jsonlines-4.0.0\n",
      "  Attempting uninstall: jinja2\n",
      "    Found existing installation: Jinja2 3.1.4\n",
      "    Uninstalling Jinja2-3.1.4:\n",
      "      Successfully uninstalled Jinja2-3.1.4\n",
      "  Attempting uninstall: janus\n",
      "    Found existing installation: janus 1.0.0\n",
      "    Uninstalling janus-1.0.0:\n",
      "      Successfully uninstalled janus-1.0.0\n",
      "  Attempting uninstall: importlib-metadata\n",
      "    Found existing installation: importlib_metadata 8.0.0\n",
      "    Uninstalling importlib_metadata-8.0.0:\n",
      "      Successfully uninstalled importlib_metadata-8.0.0\n",
      "  Attempting uninstall: h5py\n",
      "    Found existing installation: h5py 3.10.0\n",
      "    Uninstalling h5py-3.10.0:\n",
      "      Successfully uninstalled h5py-3.10.0\n",
      "  Attempting uninstall: coloredlogs\n",
      "    Found existing installation: coloredlogs 15.0.1\n",
      "    Uninstalling coloredlogs-15.0.1:\n",
      "      Successfully uninstalled coloredlogs-15.0.1\n",
      "  Attempting uninstall: build\n",
      "    Found existing installation: build 1.2.1\n",
      "    Uninstalling build-1.2.1:\n",
      "      Successfully uninstalled build-1.2.1\n",
      "  Attempting uninstall: aiosignal\n",
      "    Found existing installation: aiosignal 1.3.1\n",
      "    Uninstalling aiosignal-1.3.1:\n",
      "      Successfully uninstalled aiosignal-1.3.1\n",
      "  Attempting uninstall: tensorrt-cu12\n",
      "    Found existing installation: tensorrt-cu12 10.1.0\n",
      "    Uninstalling tensorrt-cu12-10.1.0:\n",
      "      Successfully uninstalled tensorrt-cu12-10.1.0\n",
      "  Attempting uninstall: rouge_score\n",
      "    Found existing installation: rouge_score 0.1.2\n",
      "    Uninstalling rouge_score-0.1.2:\n",
      "      Successfully uninstalled rouge_score-0.1.2\n",
      "  Attempting uninstall: rich\n",
      "    Found existing installation: rich 13.7.1\n",
      "    Uninstalling rich-13.7.1:\n",
      "      Successfully uninstalled rich-13.7.1\n",
      "  Attempting uninstall: pytest-xdist\n",
      "    Found existing installation: pytest-xdist 3.6.1\n",
      "    Uninstalling pytest-xdist-3.6.1:\n",
      "      Successfully uninstalled pytest-xdist-3.6.1\n",
      "  Attempting uninstall: pytest-forked\n",
      "    Found existing installation: pytest-forked 1.6.0\n",
      "    Uninstalling pytest-forked-1.6.0:\n",
      "      Successfully uninstalled pytest-forked-1.6.0\n",
      "  Attempting uninstall: pytest-cov\n",
      "    Found existing installation: pytest-cov 5.0.0\n",
      "    Uninstalling pytest-cov-5.0.0:\n",
      "      Successfully uninstalled pytest-cov-5.0.0\n",
      "  Attempting uninstall: pydantic\n",
      "    Found existing installation: pydantic 2.8.2\n",
      "    Uninstalling pydantic-2.8.2:\n",
      "      Successfully uninstalled pydantic-2.8.2\n",
      "  Attempting uninstall: pre-commit\n",
      "    Found existing installation: pre-commit 3.7.1\n",
      "    Uninstalling pre-commit-3.7.1:\n",
      "      Successfully uninstalled pre-commit-3.7.1\n",
      "  Attempting uninstall: pandas\n",
      "    Found existing installation: pandas 2.2.2\n",
      "    Uninstalling pandas-2.2.2:\n",
      "      Successfully uninstalled pandas-2.2.2\n",
      "  Attempting uninstall: nvidia-cusolver-cu12\n",
      "    Found existing installation: nvidia-cusolver-cu12 11.4.5.107\n",
      "    Uninstalling nvidia-cusolver-cu12-11.4.5.107:\n",
      "      Successfully uninstalled nvidia-cusolver-cu12-11.4.5.107\n",
      "  Attempting uninstall: huggingface-hub\n",
      "    Found existing installation: huggingface-hub 0.23.4\n",
      "    Uninstalling huggingface-hub-0.23.4:\n",
      "      Successfully uninstalled huggingface-hub-0.23.4\n",
      "  Attempting uninstall: aiohttp\n",
      "    Found existing installation: aiohttp 3.9.5\n",
      "    Uninstalling aiohttp-3.9.5:\n",
      "      Successfully uninstalled aiohttp-3.9.5\n",
      "  Attempting uninstall: torch\n",
      "    Found existing installation: torch 2.3.1\n",
      "    Uninstalling torch-2.3.1:\n",
      "      Successfully uninstalled torch-2.3.1\n",
      "  Attempting uninstall: tokenizers\n",
      "    Found existing installation: tokenizers 0.19.1\n",
      "    Uninstalling tokenizers-0.19.1:\n",
      "      Successfully uninstalled tokenizers-0.19.1\n",
      "  Attempting uninstall: nvidia-modelopt\n",
      "    Found existing installation: nvidia-modelopt 0.13.1\n",
      "    Uninstalling nvidia-modelopt-0.13.1:\n",
      "      Successfully uninstalled nvidia-modelopt-0.13.1\n",
      "  Attempting uninstall: diffusers\n",
      "    Found existing installation: diffusers 0.29.2\n",
      "    Uninstalling diffusers-0.29.2:\n",
      "      Successfully uninstalled diffusers-0.29.2\n",
      "  Attempting uninstall: bandit\n",
      "    Found existing installation: bandit 1.7.7\n",
      "    Uninstalling bandit-1.7.7:\n",
      "      Successfully uninstalled bandit-1.7.7\n",
      "  Attempting uninstall: transformers\n",
      "    Found existing installation: transformers 4.42.4\n",
      "    Uninstalling transformers-4.42.4:\n",
      "      Successfully uninstalled transformers-4.42.4\n",
      "  Attempting uninstall: datasets\n",
      "    Found existing installation: datasets 2.19.2\n",
      "    Uninstalling datasets-2.19.2:\n",
      "      Successfully uninstalled datasets-2.19.2\n",
      "  Attempting uninstall: accelerate\n",
      "    Found existing installation: accelerate 0.32.1\n",
      "    Uninstalling accelerate-0.32.1:\n",
      "      Successfully uninstalled accelerate-0.32.1\n",
      "  Attempting uninstall: evaluate\n",
      "    Found existing installation: evaluate 0.4.2\n",
      "    Uninstalling evaluate-0.4.2:\n",
      "      Successfully uninstalled evaluate-0.4.2\n",
      "  Attempting uninstall: optimum\n",
      "    Found existing installation: optimum 1.21.2\n",
      "    Uninstalling optimum-1.21.2:\n",
      "      Successfully uninstalled optimum-1.21.2\n",
      "\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n",
      "cucim 24.4.0 requires cupy-cuda11x>=12.0.0, which is not installed.\n",
      "cudf 24.4.1 requires cubinlinker, which is not installed.\n",
      "cudf 24.4.1 requires cupy-cuda11x>=12.0.0, which is not installed.\n",
      "cudf 24.4.1 requires ptxcompiler, which is not installed.\n",
      "cugraph 24.4.0 requires cupy-cuda11x>=12.0.0, which is not installed.\n",
      "cuml 24.4.0 requires cupy-cuda11x>=12.0.0, which is not installed.\n",
      "cuxfilter 24.4.1 requires cupy-cuda11x>=12.0.0, which is not installed.\n",
      "dask-cudf 24.4.1 requires cupy-cuda11x>=12.0.0, which is not installed.\n",
      "nx-cugraph 24.4.0 requires cupy-cuda11x>=12.0.0, which is not installed.\n",
      "cudf 24.4.1 requires cuda-python<12.0a0,>=11.7.1, but you have cuda-python 12.5.0 which is incompatible.\n",
      "cudf 24.4.1 requires pandas<2.2.2dev0,>=2.0, but you have pandas 2.2.2 which is incompatible.\n",
      "cudf 24.4.1 requires protobuf<5,>=3.20, but you have protobuf 5.27.2 which is incompatible.\n",
      "cudf 24.4.1 requires pyarrow<15.0.0a0,>=14.0.1, but you have pyarrow 16.1.0 which is incompatible.\n",
      "dask-cuda 24.4.0 requires pynvml<11.5,>=11.0.0, but you have pynvml 11.5.2 which is incompatible.\n",
      "dask-cudf 24.4.1 requires pandas<2.2.2dev0,>=2.0, but you have pandas 2.2.2 which is incompatible.\n",
      "pylibraft 24.4.0 requires cuda-python<12.0a0,>=11.7.1, but you have cuda-python 12.5.0 which is incompatible.\n",
      "pyppeteer 1.0.2 requires urllib3<2.0.0,>=1.25.8, but you have urllib3 2.2.2 which is incompatible.\n",
      "rmm 24.4.0 requires cuda-python<12.0a0,>=11.7.1, but you have cuda-python 12.5.0 which is incompatible.\u001b[0m\u001b[31m\n",
      "\u001b[0mSuccessfully installed MarkupSafe-2.1.5 StrEnum-0.4.15 absl-py-2.1.0 accelerate-0.32.1 aiohttp-3.9.5 aiosignal-1.3.1 annotated-types-0.7.0 async-timeout-4.0.3 attrs-23.2.0 bandit-1.7.7 build-1.2.1 certifi-2024.7.4 cfgv-3.4.0 charset-normalizer-3.3.2 click-8.1.7 cloudpickle-3.0.0 colored-2.2.4 coloredlogs-15.0.1 coverage-7.6.0 cuda-python-12.5.0 datasets-2.19.2 diffusers-0.29.2 dill-0.3.8 distlib-0.3.8 einops-0.8.0 evaluate-0.4.2 exceptiongroup-1.2.2 execnet-2.1.1 filelock-3.15.4 frozenlist-1.4.1 fsspec-2024.3.1 graphviz-0.20.3 h5py-3.10.0 huggingface-hub-0.23.4 humanfriendly-10.0 identify-2.6.0 idna-3.7 importlib-metadata-8.0.0 iniconfig-2.0.0 janus-1.0.0 jieba-0.42.1 jinja2-3.1.4 joblib-1.4.2 jsonlines-4.0.0 lark-1.1.9 markdown-it-py-3.0.0 mdurl-0.1.2 mpi4py-3.1.6 mpmath-1.3.0 multidict-6.0.5 multiprocess-0.70.16 mypy-1.10.1 mypy-extensions-1.0.0 networkx-3.3 ninja-1.11.1.1 nltk-3.8.1 nodeenv-1.9.1 numpy-1.26.4 nvidia-cublas-cu12-12.1.3.1 nvidia-cuda-cupti-cu12-12.1.105 nvidia-cuda-nvrtc-cu12-12.1.105 nvidia-cuda-runtime-cu12-12.1.105 nvidia-cudnn-cu12-8.9.2.26 nvidia-cufft-cu12-11.0.2.54 nvidia-curand-cu12-10.3.2.106 nvidia-cusolver-cu12-11.4.5.107 nvidia-cusparse-cu12-12.1.0.106 nvidia-modelopt-0.13.1 nvidia-nccl-cu12-2.20.5 nvidia-nvjitlink-cu12-12.5.82 nvidia-nvtx-cu12-12.1.105 onnx-1.16.1 optimum-1.21.2 packaging-24.1 pandas-2.2.2 parameterized-0.9.0 pbr-6.0.0 pillow-10.3.0 platformdirs-4.2.2 pluggy-1.5.0 polygraphy-0.49.9 pre-commit-3.7.1 protobuf-5.27.2 psutil-6.0.0 pulp-2.9.0 py-1.11.0 pyarrow-16.1.0 pyarrow-hotfix-0.6 pybind11-2.13.1 pybind11-stubgen-2.5.1 pydantic-2.8.2 pydantic-core-2.20.1 pygments-2.18.0 pynvml-11.5.2 pyproject_hooks-1.1.0 pytest-8.2.2 pytest-cov-5.0.0 pytest-forked-1.6.0 pytest-xdist-3.6.1 python-dateutil-2.9.0.post0 pytz-2024.1 pyyaml-6.0.1 regex-2024.5.15 requests-2.32.3 rich-13.7.1 rouge-1.0.1 rouge_score-0.1.2 safetensors-0.4.3 scipy-1.14.0 sentencepiece-0.2.0 six-1.16.0 stevedore-5.2.0 sympy-1.13.0 tensorrt-cu12-10.1.0 tensorrt-cu12-bindings-10.1.0 tensorrt-cu12-libs-10.1.0 tokenizers-0.19.1 tomli-2.0.1 torch-2.3.1 tqdm-4.66.4 transformers-4.42.4 triton-2.3.1 typing-extensions-4.8.0 tzdata-2024.1 urllib3-2.2.2 virtualenv-20.26.3 wheel-0.43.0 xxhash-3.4.1 yarl-1.9.4 zipp-3.19.2\n",
      "\u001b[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\u001b[0m\u001b[33m\n",
      "\u001b[0mCPU times: user 1.18 s, sys: 336 ms, total: 1.52 s\n",
      "Wall time: 2min 28s\n"
     ]
    }
   ],
   "source": [
    "%%time \n",
    "# 2.5 minutes\n",
    "!pip install -r TensorRT-LLM/requirements-dev.txt"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5a45de2e-480c-402f-93fd-de4ad073a47d",
   "metadata": {},
   "source": [
    "  "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a6810fb7-dad8-4f37-8af0-da0cd053dfa0",
   "metadata": {},
   "source": [
    "  "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0c9ab8fa-f63f-4d0c-b2e8-8743b72126a0",
   "metadata": {},
   "source": [
    "  "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b20d24dc-4cfb-46fd-ba4d-bf075b26f6d7",
   "metadata": {},
   "source": [
    "# Download Llama-3 8B Instruct Gradient 1048K\n",
    "### 2.5 minutes\n",
    "##### https://huggingface.co/gradientai/Llama-3-8B-Instruct-Gradient-1048k"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "4e9fba1d-93bc-40ab-bd99-8e5c0191358f",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "WARNING: 'git lfs clone' is deprecated and will not be updated\n",
      "          with new flags from 'git clone'\n",
      "\n",
      "'git clone' has been updated in upstream Git to have comparable\n",
      "speeds to 'git lfs clone'.\n",
      "Cloning into 'Llama-3-8B-Instruct-Gradient-1048k'...\n",
      "remote: Enumerating objects: 96, done.\u001b[K\n",
      "remote: Counting objects: 100% (93/93), done.\u001b[K\n",
      "remote: Compressing objects: 100% (93/93), done.\u001b[K\n",
      "remote: Total 96 (delta 49), reused 0 (delta 0), pack-reused 3 (from 1)\u001b[K\n",
      "Unpacking objects: 100% (96/96), 2.27 MiB | 8.39 MiB/s, done.\n",
      "CPU times: user 1.33 s, sys: 388 ms, total: 1.72 sB/s                           \n",
      "Wall time: 2min 39s\n"
     ]
    }
   ],
   "source": [
    "%%time \n",
    "# 2.5 minutes\n",
    "\n",
    "!git-lfs clone https://huggingface.co/gradientai/Llama-3-8B-Instruct-Gradient-1048k/"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "13e7030d-4107-424f-813d-f2fe84e19319",
   "metadata": {},
   "source": [
    "  "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "acb18c81-eb90-4f68-8ddc-d58309819170",
   "metadata": {},
   "source": [
    "  "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "af539f4f-721c-4011-ae50-ec0f78c3dfe0",
   "metadata": {},
   "source": [
    "# Convert Checkpoint \n",
    "### 12 Minutes\n",
    "##### output dir --> /home/rapids/notebooks/Llama-3-8B-Instruct-Gradient-1048k/trt_ckpts"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "987fe9f9-dadc-4ef2-8a02-69608846659f",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[TensorRT-LLM] TensorRT-LLM version: 0.12.0.dev2024070900\n",
      "0.12.0.dev2024070900\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "\n",
    "# 12 minutes\n",
    "!python TensorRT-LLM/examples/llama/convert_checkpoint.py \\\n",
    "    --model_dir  Llama-3-8B-Instruct-Gradient-1048k/ \\\n",
    "    --output_dir Llama-3-8B-Instruct-Gradient-1048k/trt_ckpts \\\n",
    "    --dtype float16 \\\n",
    "    --tp_size 4"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3ebc5a49-656b-4b99-bb93-53d437cb7f0f",
   "metadata": {},
   "source": [
    "  "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "34229e5a-5548-44b0-ac64-ada7088bce43",
   "metadata": {},
   "source": [
    "  "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "aa3c9cc9-4170-406e-bd75-475a24d6c52e",
   "metadata": {},
   "source": [
    "# Build TensorRT-LLM Engine\n",
    "### 6 minutes\n",
    "###### output dir --> /home/rapids/notebooks/Llama-3-8B-Instruct-Gradient-1048k/trt_engines"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2fc8e6a8-d158-4a0b-93cc-c51d1676c456",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "%%time \n",
    "# 6 minutes\n",
    "\n",
    "!python -m tensorrt_llm.commands.build \\\n",
    "            --checkpoint_dir Llama-3-8B-Instruct-Gradient-1048k/trt_ckpts \\\n",
    "            --output_dir Llama-3-8B-Instruct-Gradient-1048k/trt_engines \\\n",
    "            --gemm_plugin float16 \\\n",
    "            --max_num_tokens 4096 \\\n",
    "            --max_input_len 1048566 \\\n",
    "            --max_seq_len 1048576 \\\n",
    "            --use_paged_context_fmha enable \\\n",
    "            --workers 4"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0595e0aa-bd10-4218-87bf-8cf7b771239b",
   "metadata": {},
   "source": [
    "  "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d20cfa49-9f24-4cb9-b9ed-f9bb5d719ec6",
   "metadata": {},
   "source": [
    "  "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7f1815de-20d6-4b99-89ef-0510875e69de",
   "metadata": {},
   "source": [
    "  "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "03daa9f8-91cf-4bc5-b763-202fcc1798bb",
   "metadata": {},
   "source": [
    "# Prepare 1M needle-in-a-haystack datasets\n",
    "### 8 seconds"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "547899e8-fb73-458e-a6f6-c0de500c8088",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "%%time \n",
    "# 8 seconds\n",
    "\n",
    "!python ./TensorRT-LLM/examples/infinitebench/construct_synthetic_dataset.py \\\n",
    "    --test_case build_passkey \\\n",
    "    --test_level 7"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0fc127be-dd6b-4c9b-bd5a-35c21ac1144b",
   "metadata": {},
   "source": [
    "### Inspect Synthetic Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "12e2dc12-9f15-4433-9a2a-4aa515718242",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "!wc -c passkey.jsonl\n",
    "!wc -w passkey.jsonl\n",
    "!head -c 150 passkey.jsonl && printf '\\n.....\\n' && tail -c 250 passkey.jsonl"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b0b04c7b-851c-406d-adf9-04a9bf5491ca",
   "metadata": {},
   "source": [
    "### Run Inference"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ac372b62-72e8-4da5-a159-e4170fcc7ca6",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "!mkdir -p 1M_context"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cbec335a-f239-401a-9510-68ddf290f0d8",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "%%time\n",
    "# <1 second\n",
    "\n",
    "!mpirun -n 4   --allow-run-as-root python3 TensorRT-LLM/examples/eval_long_context.py \\\n",
    "               --task passkey \\\n",
    "               --engine_dir /home/rapids/notebooks/Llama-3-8B-Instruct-Gradient-1048k/trt_engines \\\n",
    "               --tokenizer_dir ./Llama-3-8B-Instruct-Gradient-1048k/ \\\n",
    "               --stop_idx 1 \\\n",
    "               --max_input_length 1048566 \\\n",
    "               --enable_chunked_context \\\n",
    "               --max_tokens_in_paged_kv_cache 1100000 \\\n",
    "               --output_dir ./1M_context"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4ec6dbda-4b6a-4d57-a2e7-14df82a35305",
   "metadata": {},
   "source": [
    "  "
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.14"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
